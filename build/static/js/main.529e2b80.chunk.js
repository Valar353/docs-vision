(this["webpackJsonpdocs-vision-v1"]=this["webpackJsonpdocs-vision-v1"]||[]).push([[0],{1:function(e,t,n){e.exports={equipment:"Equipment_equipment__3CMZL",equipmentTitle:"Equipment_equipmentTitle__uMNA1",equipmentList:"Equipment_equipmentList__1-ZOQ",wrapperForm:"Equipment_wrapperForm__1EaEI",addForm:"Equipment_addForm__1PRcv",title:"Equipment_title__37MxK",item:"Equipment_item__1PUja",buttons:"Equipment_buttons__1P0r1",btn:"Equipment_btn__3VwtS",name:"Equipment_name__2ARmM",count:"Equipment_count__xn1xt",buildBlock:"Equipment_buildBlock__MITG_",blockTitle:"Equipment_blockTitle__2VxX_",blockEquipmentList:"Equipment_blockEquipmentList__3UNh0"}},10:function(e,t,n){e.exports={nav:"Nav_nav__zU2Ku",buildings:"Nav_buildings__2HFRj",roomBlock:"Nav_roomBlock__2BPEK",title:"Nav_title__126xE",equipmentIcon:"Nav_equipmentIcon__1cnCP",element:"Nav_element__QxcOG"}},2:function(e,t,n){(function(t){var n;e.exports=function e(t,r,i){function o(a,u){if(!r[a]){if(!t[a]){if(!u&&"function"==typeof n&&n)return n(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[a]={exports:{}};t[a][0].call(l.exports,(function(e){var n=t[a][1][e];return o(n||e)}),l,l.exports,e,t,r,i)}return r[a].exports}for(var s="function"==typeof n&&n,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,t,n){"use strict";function r(e){return o[e>>18&63]+o[e>>12&63]+o[e>>6&63]+o[63&e]}function i(e,t,n){for(var i,o=[],s=t;n>s;s+=3)i=(e[s]<<16)+(e[s+1]<<8)+e[s+2],o.push(r(i));return o.join("")}n.toByteArray=function(e){var t,n,r,i,o,u,c=e.length;if(c%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[c-2]?2:"="===e[c-1]?1:0,u=new a(3*c/4-o),r=o>0?c-4:c;var l=0;for(t=0,n=0;r>t;t+=4,n+=3)i=s[e.charCodeAt(t)]<<18|s[e.charCodeAt(t+1)]<<12|s[e.charCodeAt(t+2)]<<6|s[e.charCodeAt(t+3)],u[l++]=i>>16&255,u[l++]=i>>8&255,u[l++]=255&i;return 2===o?(i=s[e.charCodeAt(t)]<<2|s[e.charCodeAt(t+1)]>>4,u[l++]=255&i):1===o&&(i=s[e.charCodeAt(t)]<<10|s[e.charCodeAt(t+1)]<<4|s[e.charCodeAt(t+2)]>>2,u[l++]=i>>8&255,u[l++]=255&i),u},n.fromByteArray=function(e){for(var t,n=e.length,r=n%3,s="",a=[],u=16383,c=0,l=n-r;l>c;c+=u)a.push(i(e,c,c+u>l?l:c+u));return 1===r?(t=e[n-1],s+=o[t>>2],s+=o[t<<4&63],s+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],s+=o[t>>10],s+=o[t>>4&63],s+=o[t<<2&63],s+="="),a.push(s),a.join("")};var o=[],s=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array;!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;n>t;++t)o[t]=e[t],s[e.charCodeAt(t)]=t;s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63}()},{}],2:[function(e,t,n){(function(r,i){var o=e("fs"),s=e("path"),a=s.join,u=s.dirname,c=o.existsSync||s.existsSync,l={arrow:r.env.NODE_BINDINGS_ARROW||" \u2192 ",compiled:r.env.NODE_BINDINGS_COMPILED_DIR||"compiled",platform:r.platform,arch:r.arch,version:r.versions.node,bindings:"bindings.node",try:[["module_root","build","bindings"],["module_root","build","Debug","bindings"],["module_root","build","Release","bindings"],["module_root","out","Debug","bindings"],["module_root","Debug","bindings"],["module_root","out","Release","bindings"],["module_root","Release","bindings"],["module_root","build","default","bindings"],["module_root","compiled","version","platform","arch","bindings"]]};t.exports=n=function(t){"string"==typeof t?t={bindings:t}:t||(t={}),t.__proto__=l,t.module_root||(t.module_root=n.getRoot(n.getFileName())),".node"!=s.extname(t.bindings)&&(t.bindings+=".node");for(var r,i,o,u=[],c=0,f=t.try.length;f>c;c++){r=a.apply(null,t.try[c].map((function(e){return t[e]||e}))),u.push(r);try{return i=t.path?e.resolve(r):e(r),t.path||(i.path=r),i}catch(h){if(!/not find/i.test(h.message))throw h}}throw(o=new Error("Could not locate the bindings file. Tried:\n"+u.map((function(e){return t.arrow+e})).join("\n"))).tries=u,o},n.getFileName=function(e){var t,n=Error.prepareStackTrace,r=Error.stackTraceLimit,o={};return Error.stackTraceLimit=10,Error.prepareStackTrace=function(n,r){for(var o=0,s=r.length;s>o;o++)if((t=r[o].getFileName())!==i){if(!e)return;if(t!==e)return}},Error.captureStackTrace(o),Error.prepareStackTrace=n,Error.stackTraceLimit=r,t},n.getRoot=function(e){for(var t,n=u(e);;){if("."===n&&(n=r.cwd()),c(a(n,"package.json"))||c(a(n,"node_modules")))return n;if(t===n)throw new Error('Could not find module root given file: "'+e+'". Do you have a `package.json` file? ');t=n,n=a(n,"..")}}}).call(this,e("_process"),"/node_modules/bindings/bindings.js")},{_process:3,fs:void 0,path:void 0}],3:[function(e,t,n){},{}],4:[function(e,n,r){(function(t){"use strict";function n(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=o.prototype:(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,n){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return s(this,e,t,n)}function s(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,0>n||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),o.TYPED_ARRAY_SUPPORT?(e=t).__proto__=o.prototype:e=c(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!o.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(t,n);return(e=i(e,r)).write(t,n),e}(e,t,n):function(e,t){if(o.isBuffer(t)){var n=0|l(t.length);return 0===(e=i(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!==e}(t.length)?i(e,0):c(e,t);if("Buffer"===t.type&&q(t.data))return c(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number')}function u(e,t){if(a(t),e=i(e,0>t?0:0|l(t)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;t>n;n++)e[n]=0;return e}function c(e,t){var n=0|l(t.length);e=i(e,n);for(var r=0;n>r;r+=1)e[r]=255&t[r];return e}function l(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function f(e,t){if(o.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"binary":case"raw":case"raws":return n;case"utf8":case"utf-8":case void 0:return D(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return I(e).length;default:if(r)return D(e).length;t=(""+t).toLowerCase(),r=!0}}function h(e,t,n){var r=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),0>=n)return"";if((t>>>=0)>=(n>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return x(this,t,n);case"utf8":case"utf-8":return E(this,t,n);case"ascii":return S(this,t,n);case"binary":return O(this,t,n);case"base64":return b(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function p(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function d(e,t,n,r){function i(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}var o=1,s=e.length,a=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,a/=2,n/=2}for(var u=-1,c=0;s>n+c;c++)if(i(e,n+c)===i(t,-1===u?0:c-u)){if(-1===u&&(u=c),c-u+1===a)return(n+u)*o}else-1!==u&&(c-=c-u),u=-1;return-1}function v(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!==0)throw new Error("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;r>s;s++){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function y(e,t,n,r){return B(D(t,e.length-n),e,n,r)}function m(e,t,n,r){return B(function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function g(e,t,n,r){return m(e,t,n,r)}function _(e,t,n,r){return B(I(t),e,n,r)}function w(e,t,n,r){return B(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);s++)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function b(e,t,n){return 0===t&&n===e.length?j.fromByteArray(e):j.fromByteArray(e.slice(t,n))}function E(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;n>i;){var o,s,a,u,c=e[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(n>=i+f)switch(f){case 1:128>c&&(l=c);break;case 2:128===(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],s=e[i+2],128===(192&o)&&128===(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(55296>u||u>57343)&&(l=u);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128===(192&o)&&128===(192&s)&&128===(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&1114112>u&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(e){var t=e.length;if(H>=t)return String.fromCharCode.apply(String,e);for(var n="",r=0;t>r;)n+=String.fromCharCode.apply(String,e.slice(r,r+=H));return n}(r)}function S(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;n>i;i++)r+=String.fromCharCode(127&e[i]);return r}function O(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;n>i;i++)r+=String.fromCharCode(e[i]);return r}function x(e,t,n){var r=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=t;n>o;o++)i+=U(e[o]);return i}function k(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function P(e,t,n){if(e%1!==0||0>e)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function C(e,t,n,r,i,s){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||s>t)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function R(e,t,n,r){0>t&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);o>i;i++)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function T(e,t,n,r){0>t&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);o>i;i++)e[n+i]=t>>>8*(r?i:3-i)&255}function N(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("Index out of range")}function A(e,t,n,r,i){return i||N(e,0,n,4),M.write(e,t,n,r,23,4),n+4}function L(e,t,n,r,i){return i||N(e,0,n,8),M.write(e,t,n,r,52,8),n+8}function U(e){return 16>e?"0"+e.toString(16):e.toString(16)}function D(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],s=0;r>s;s++){if((n=e.charCodeAt(s))>55295&&57344>n){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(56320>n){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,128>n){if((t-=1)<0)break;o.push(n)}else if(2048>n){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(65536>n){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(1114112>n))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function I(e){return j.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function B(e,t,n,r){for(var i=0;r>i&&!(i+n>=t.length||i>=e.length);i++)t[i+n]=e[i];return i}var j=e("base64-js"),M=e("ieee754"),q=e("isarray");r.Buffer=o,r.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},r.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),r.kMaxLength=n(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,n){return s(null,e,t,n)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,n){return function(e,t,n,r){return a(t),0>=t?i(e,t):void 0!==n?"string"==typeof r?i(e,t).fill(n,r):i(e,t).fill(n):i(e,t)}(null,e,t,n)},o.allocUnsafe=function(e){return u(null,e)},o.allocUnsafeSlow=function(e){return u(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,s=Math.min(n,r);s>i;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return r>n?-1:n>r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;n++)t+=e[n].length;var r=o.allocUnsafe(t),i=0;for(n=0;n<e.length;n++){var s=e[n];if(!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},o.byteLength=f,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;e>t;t+=2)p(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;e>t;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?E(this,0,e):h.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,n,r,i){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),0>t||n>e.length||0>r||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var s=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),u=Math.min(s,a),c=this.slice(r,i),l=e.slice(t,n),f=0;u>f;++f)if(c[f]!==l[f]){s=c[f],a=l[f];break}return a>s?-1:s>a?1:0},o.prototype.indexOf=function(e,t,n){if("string"==typeof t?(n=t,t=0):t>2147483647?t=2147483647:-2147483648>t&&(t=-2147483648),t>>=0,0===this.length)return-1;if(t>=this.length)return-1;if(0>t&&(t=Math.max(this.length+t,0)),"string"==typeof e&&(e=o.from(e,n)),o.isBuffer(e))return 0===e.length?-1:d(this,e,t,n);if("number"==typeof e)return o.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,e,t):d(this,[e],t,n);throw new TypeError("val must be string, number or Buffer")},o.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},o.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(0>n||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return y(this,e,t,n);case"ascii":return m(this,e,t,n);case"binary":return g(this,e,t,n);case"base64":return _(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var H=4096;o.prototype.slice=function(e,t){var n,r=this.length;if(0>(e=~~e)?0>(e+=r)&&(e=0):e>r&&(e=r),0>(t=void 0===t?r:~~t)?0>(t+=r)&&(t=0):t>r&&(t=r),e>t&&(t=e),o.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=o.prototype;else{var i=t-e;n=new o(i,void 0);for(var s=0;i>s;s++)n[s]=this[s+e]}return n},o.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},o.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},o.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),M.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),M.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),M.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),M.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||C(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},o.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||C(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},o.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):T(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):T(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);C(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)0>e&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},o.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);C(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)0>e&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),0>e&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):T(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):T(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,n){return A(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return A(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&n>r&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>r)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,s=r-n;if(this===e&&t>n&&r>t)for(i=s-1;i>=0;i--)e[i+t]=this[i+n];else if(1e3>s||!o.TYPED_ARRAY_SUPPORT)for(i=0;s>i;i++)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),t);return s},o.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);256>i&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(0>t||this.length<t||this.length<n)throw new RangeError("Out of range index");if(t>=n)return this;var s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(s=t;n>s;s++)this[s]=e;else{var a=o.isBuffer(e)?e:D(new o(e,r).toString()),u=a.length;for(s=0;n-t>s;s++)this[s+t]=a[s%u]}return this};var F=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:8,isarray:5}],5:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],6:[function(e,t,n){"use strict";t.exports.BufferUtil={merge:function(e,t){for(var n=0,r=0,i=t.length;i>n;++n){var o=t[n];o.copy(e,r),r+=o.length}},mask:function(e,t,n,r,i){for(var o,s=t.readUInt32LE(0,!0),a=0;i-3>a;a+=4)0>(o=s^e.readUInt32LE(a,!0))&&(o=4294967296+o),n.writeUInt32LE(o,r+a,!0);switch(i%4){case 3:n[r+a+2]=e[a+2]^t[2];case 2:n[r+a+1]=e[a+1]^t[1];case 1:n[r+a]=e[a]^t[0]}},unmask:function(e,t){for(var n,r=t.readUInt32LE(0,!0),i=e.length,o=0;i-3>o;o+=4)0>(n=r^e.readUInt32LE(o,!0))&&(n=4294967296+n),e.writeUInt32LE(n,o,!0);switch(i%4){case 3:e[o+2]=e[o+2]^t[2];case 2:e[o+1]=e[o+1]^t[1];case 1:e[o]=e[o]^t[0]}}}},{}],7:[function(e,t,n){"use strict";try{t.exports=e("bindings")("bufferutil")}catch(r){t.exports=e("./fallback")}},{"./fallback":6,bindings:2}],8:[function(e,t,n){n.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,p=e[t+f];for(f+=h,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+e[t+f],f+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},n.write=function(e,t,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,v=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(s++,u/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(t*u-1)*Math.pow(2,i),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+p]=255&s,p+=d,s/=256,c-=8);e[n+p-d]|=128*v}},{}],9:[function(e,t,n){var r=e("fs");t.exports=function(e){var t={},n=this.value={};Object.keys(e).forEach((function(r){t[r]=e[r],Object.defineProperty(n,r,{get:function(){return t[r]},configurable:!1,enumerable:!0})})),this.reset=function(){return Object.keys(e).forEach((function(n){t[n]=e[n]})),this},this.merge=function(e,n){if(e=e||{},"[object Array]"===Object.prototype.toString.call(n)){for(var r=[],i=0,o=n.length;o>i;++i){var s=n[i];s in e||r.push(s)}if(r.length>0)throw r.length>1?new Error("options "+r.slice(0,r.length-1).join(", ")+" and "+r[r.length-1]+" must be defined"):new Error("option "+r[0]+" must be defined")}return Object.keys(e).forEach((function(n){n in t&&(t[n]=e[n])})),this},this.copy=function(t){var r={};return Object.keys(e).forEach((function(e){-1!==t.indexOf(e)&&(r[e]=n[e])})),r},this.read=function(e,t){if("function"==typeof t){var n=this;r.readFile(e,(function(e,r){if(e)return t(e);var i=JSON.parse(r);n.merge(i),t()}))}else{var i=JSON.parse(r.readFileSync(e));this.merge(i)}return this},this.isDefined=function(e){return"undefined"!=typeof n[e]},this.isDefinedAndNonNull=function(e){return"undefined"!=typeof n[e]&&null!==n[e]},Object.freeze(n),Object.freeze(this)}},{fs:void 0}],10:[function(e,t,n){"use strict";function r(e){return this instanceof r?(this.id=o++,void(this.ee=e)):new r(e)}var i=Object.prototype.hasOwnProperty,o=0;r.prototype.on=function(e,t,n){return t.__ultron=this.id,this.ee.on(e,t,n),this},r.prototype.once=function(e,t,n){return t.__ultron=this.id,this.ee.once(e,t,n),this},r.prototype.remove=function(){var e,t=arguments;if(1===t.length&&"string"==typeof t[0])t=t[0].split(/[, ]+/);else if(!t.length)for(e in t=[],this.ee._events)i.call(this.ee._events,e)&&t.push(e);for(var n=0;n<t.length;n++)for(var r=this.ee.listeners(t[n]),o=0;o<r.length;o++){if((e=r[o]).listener){if(e.listener.__ultron!==this.id)continue;delete e.listener.__ultron}else{if(e.__ultron!==this.id)continue;delete e.__ultron}this.ee.removeListener(t[n],e)}return this},r.prototype.destroy=function(){return!!this.ee&&(this.remove(),this.ee=null,!0)},t.exports=r},{}],11:[function(e,t,n){"use strict";t.exports.Validation={isValidUTF8:function(e){return!0}}},{}],12:[function(e,t,n){"use strict";try{t.exports=e("bindings")("validation")}catch(r){t.exports=e("./fallback")}},{"./fallback":11,bindings:2}],13:[function(e,t,n){"use strict";var r=t.exports=e("./lib/WebSocket");r.Server=e("./lib/WebSocketServer"),r.Sender=e("./lib/Sender"),r.Receiver=e("./lib/Receiver"),r.createServer=function(e,t){var n=new r.Server(e);return"function"==typeof t&&n.on("connection",t),n},r.connect=r.createConnection=function(e,t){var n=new r(e);return"function"==typeof t&&n.on("open",t),n}},{"./lib/Receiver":21,"./lib/Sender":23,"./lib/WebSocket":26,"./lib/WebSocketServer":27}],14:[function(e,t,n){(function(n){function r(e,t,i){if(this instanceof r==0)throw new TypeError("Classes can't be function-called");"function"==typeof e?(i=t,t=e,e=0):"undefined"==typeof e&&(e=0),this._growStrategy=(t||function(e,t){return e.used+t}).bind(null,this),this._shrinkStrategy=(i||function(t){return e}).bind(null,this),this._buffer=e?new n(e):null,this._offset=0,this._used=0,this._changeFactor=0,this.__defineGetter__("size",(function(){return null==this._buffer?0:this._buffer.length})),this.__defineGetter__("used",(function(){return this._used}))}e("util"),r.prototype.get=function(e){if(null==this._buffer||this._offset+e>this._buffer.length){var t=new n(this._growStrategy(e));this._buffer=t,this._offset=0}this._used+=e;var r=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,r},r.prototype.reset=function(e){var t=this._shrinkStrategy();t<this.size&&(this._changeFactor-=1),(e||this._changeFactor<-2)&&(this._changeFactor=0,this._buffer=t?new n(t):null),this._offset=0,this._used=0},t.exports=r}).call(this,e("buffer").Buffer)},{buffer:4,util:void 0}],15:[function(e,t,n){n.BufferUtil={merge:function(e,t){for(var n=0,r=0,i=t.length;i>r;++r){var o=t[r];o.copy(e,n),n+=o.length}},mask:function(e,t,n,r,i){for(var o=t.readUInt32LE(0,!0),s=0;i-3>s;s+=4){var a=o^e.readUInt32LE(s,!0);0>a&&(a=4294967296+a),n.writeUInt32LE(a,r+s,!0)}switch(i%4){case 3:n[r+s+2]=e[s+2]^t[2];case 2:n[r+s+1]=e[s+1]^t[1];case 1:n[r+s]=e[s]^t[0]}},unmask:function(e,t){for(var n=t.readUInt32LE(0,!0),r=e.length,i=0;r-3>i;i+=4){var o=n^e.readUInt32LE(i,!0);0>o&&(o=4294967296+o),e.writeUInt32LE(o,i,!0)}switch(r%4){case 3:e[i+2]=e[i+2]^t[2];case 2:e[i+1]=e[i+1]^t[1];case 1:e[i]=e[i]^t[0]}}}},{}],16:[function(e,t,n){"use strict";try{t.exports=e("bufferutil")}catch(r){t.exports=e("./BufferUtil.fallback")}},{"./BufferUtil.fallback":15,bufferutil:7}],17:[function(e,t,n){t.exports={isValidErrorCode:function(e){return e>=1e3&&1011>=e&&1004!=e&&1005!=e&&1006!=e||e>=3e3&&4999>=e},1e3:"normal",1001:"going away",1002:"protocol error",1003:"unsupported data",1004:"reserved",1005:"reserved for extensions",1006:"reserved for extensions",1007:"inconsistent or invalid data",1008:"policy violation",1009:"message too big",1010:"extension handshake missing",1011:"an unexpected condition prevented the request from being fulfilled"}},{}],18:[function(e,t,n){var r=e("util");n.parse=function(e){var t={};return(e=e||"").split(",").forEach((function(e){var n=e.split(";"),r=n.shift().trim(),i=t[r]=t[r]||[],o={};n.forEach((function(e){var t=e.trim().split("="),n=t[0],r=t[1];"undefined"==typeof r?r=!0:('"'===r[0]&&(r=r.slice(1)),'"'===r[r.length-1]&&(r=r.slice(0,r.length-1))),(o[n]=o[n]||[]).push(r)})),i.push(o)})),t},n.format=function(e){return Object.keys(e).map((function(t){var n=e[t];return r.isArray(n)||(n=[n]),n.map((function(e){return[t].concat(Object.keys(e).map((function(t){var n=e[t];return r.isArray(n)||(n=[n]),n.map((function(e){return!0===e?t:t+"="+e})).join("; ")}))).join("; ")})).join(", ")})).join(", ")}},{util:void 0}],19:[function(e,t,n){(function(n){function r(e,t,n){if(this instanceof r==0)throw new TypeError("Classes can't be function-called");this._options=e||{},this._isServer=!!t,this._inflate=null,this._deflate=null,this.params=null,this._maxPayload=n||0}var i=e("zlib"),o=[8,9,10,11,12,13,14,15];r.extensionName="permessage-deflate",r.prototype.offer=function(){var e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e},r.prototype.accept=function(e){var t;return e=this.normalizeParams(e),t=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params=t,t},r.prototype.cleanup=function(){this._inflate&&(this._inflate.writeInProgress?this._inflate.pendingClose=!0:(this._inflate.close&&this._inflate.close(),this._inflate=null)),this._deflate&&(this._deflate.writeInProgress?this._deflate.pendingClose=!0:(this._deflate.close&&this._deflate.close(),this._deflate=null))},r.prototype.acceptAsServer=function(e){var t={};if(!e.some((function(e){return t={},!1===this._options.serverNoContextTakeover&&e.server_no_context_takeover||!1===this._options.serverMaxWindowBits&&e.server_max_window_bits||"number"==typeof this._options.serverMaxWindowBits&&"number"==typeof e.server_max_window_bits&&this._options.serverMaxWindowBits>e.server_max_window_bits||"number"==typeof this._options.clientMaxWindowBits&&!e.client_max_window_bits?void 0:((this._options.serverNoContextTakeover||e.server_no_context_takeover)&&(t.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(t.client_no_context_takeover=!0),!1!==this._options.clientNoContextTakeover&&e.client_no_context_takeover&&(t.client_no_context_takeover=!0),"number"==typeof this._options.serverMaxWindowBits?t.server_max_window_bits=this._options.serverMaxWindowBits:"number"==typeof e.server_max_window_bits&&(t.server_max_window_bits=e.server_max_window_bits),"number"==typeof this._options.clientMaxWindowBits?t.client_max_window_bits=this._options.clientMaxWindowBits:!1!==this._options.clientMaxWindowBits&&"number"==typeof e.client_max_window_bits&&(t.client_max_window_bits=e.client_max_window_bits),!0)}),this))throw new Error("Doesn't support the offered configuration");return t},r.prototype.acceptAsClient=function(e){var t=e[0];if(null!=this._options.clientNoContextTakeover&&!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Invalid value for "client_no_context_takeover"');if(null!=this._options.clientMaxWindowBits){if(!1===this._options.clientMaxWindowBits&&t.client_max_window_bits)throw new Error('Invalid value for "client_max_window_bits"');if("number"==typeof this._options.clientMaxWindowBits&&(!t.client_max_window_bits||t.client_max_window_bits>this._options.clientMaxWindowBits))throw new Error('Invalid value for "client_max_window_bits"')}return t},r.prototype.normalizeParams=function(e){return e.map((function(e){return Object.keys(e).forEach((function(t){var n=e[t];if(n.length>1)throw new Error("Multiple extension parameters for "+t);switch(n=n[0],t){case"server_no_context_takeover":case"client_no_context_takeover":if(!0!==n)throw new Error("invalid extension parameter value for "+t+" ("+n+")");e[t]=!0;break;case"server_max_window_bits":case"client_max_window_bits":if("string"==typeof n&&(n=parseInt(n,10),!~o.indexOf(n)))throw new Error("invalid extension parameter value for "+t+" ("+n+")");if(!this._isServer&&!0===n)throw new Error("Missing extension parameter value for "+t);e[t]=n;break;default:throw new Error("Not defined extension parameter ("+t+")")}}),this),e}),this)},r.prototype.decompress=function(e,t,r){function o(e){a(),r(e)}function s(e){void 0!==l._maxPayload&&null!==l._maxPayload&&l._maxPayload>0&&(h+=e.length)>l._maxPayload?(f=[],a(),r({type:1009})):f.push(e)}function a(){l._inflate&&(l._inflate.removeListener("error",o),l._inflate.removeListener("data",s),l._inflate.writeInProgress=!1,(t&&l.params[u+"_no_context_takeover"]||l._inflate.pendingClose)&&(l._inflate.close&&l._inflate.close(),l._inflate=null))}var u=this._isServer?"client":"server";if(!this._inflate){var c=this.params[u+"_max_window_bits"];this._inflate=i.createInflateRaw({windowBits:"number"==typeof c?c:15})}this._inflate.writeInProgress=!0;var l=this,f=[],h=0;this._inflate.on("error",o).on("data",s),this._inflate.write(e),t&&this._inflate.write(new n([0,0,255,255])),this._inflate.flush((function(){a(),r(null,n.concat(f))}))},r.prototype.compress=function(e,t,r){function o(e){a(),r(e)}function s(e){f.push(e)}function a(){l._deflate&&(l._deflate.removeListener("error",o),l._deflate.removeListener("data",s),l._deflate.writeInProgress=!1,(t&&l.params[u+"_no_context_takeover"]||l._deflate.pendingClose)&&(l._deflate.close&&l._deflate.close(),l._deflate=null))}var u=this._isServer?"server":"client";if(!this._deflate){var c=this.params[u+"_max_window_bits"];this._deflate=i.createDeflateRaw({flush:i.Z_SYNC_FLUSH,windowBits:"number"==typeof c?c:15,memLevel:this._options.memLevel||8})}this._deflate.writeInProgress=!0;var l=this,f=[];this._deflate.on("error",o).on("data",s),this._deflate.write(e),this._deflate.flush((function(){a();var e=n.concat(f);t&&(e=e.slice(0,e.length-4)),r(null,e)}))},t.exports=r}).call(this,e("buffer").Buffer)},{buffer:4,zlib:void 0}],20:[function(e,t,n){(function(n){function r(){if(this instanceof r==0)throw new TypeError("Classes can't be function-called");this.state=i,this.buffers=[],this.messageEnd=-1,this.spanLength=0,this.dead=!1,this.onerror=function(){},this.ontext=function(){},this.onbinary=function(){},this.onclose=function(){},this.onping=function(){},this.onpong=function(){}}var i=(e("util"),0),o=1,s=2,a=3;t.exports=r,r.prototype.add=function(e){function t(){if(n.state===i){if(2==e.length&&255==e[0]&&0==e[1])return n.reset(),void n.onclose();if(128===e[0])n.messageEnd=0,n.state=s,e=e.slice(1);else{if(0!==e[0])return void n.error("payload must start with 0x00 byte",!0);e=e.slice(1),n.state=o}}if(n.state===s){for(var t=0;t<e.length&&128&e[t];)n.messageEnd=128*n.messageEnd+(127&e[t]),++t;t<e.length&&(n.messageEnd=128*n.messageEnd+(127&e[t]),n.state=a,++t),t>0&&(e=e.slice(t))}if(n.state===a){var r=n.messageEnd-n.spanLength;return e.length>=r?(n.buffers.push(e),n.spanLength+=r,n.messageEnd=r,n.parse()):(n.buffers.push(e),void(n.spanLength+=e.length))}return n.buffers.push(e),-1!=(n.messageEnd=function(e,t){for(var n=0,r=e.length;r>n;++n)if(e[n]===t)return n;return-1}(e,255))?(n.spanLength+=n.messageEnd,n.parse()):void(n.spanLength+=e.length)}if(!this.dead)for(var n=this;e;)e=t()},r.prototype.cleanup=function(){this.dead=!0,this.state=i,this.buffers=[]},r.prototype.parse=function(){for(var e=new n(this.spanLength),t=0,r=0,i=this.buffers.length;i-1>r;++r){var s=this.buffers[r];s.copy(e,t),t+=s.length}var a=this.buffers[this.buffers.length-1];this.messageEnd>0&&a.copy(e,t,0,this.messageEnd),this.state!==o&&--this.messageEnd;var u=null;return this.messageEnd<a.length-1&&(u=a.slice(this.messageEnd+1)),this.reset(),this.ontext(e.toString("utf8")),u},r.prototype.error=function(e,t){return this.dead?void 0:(this.reset(),"string"==typeof e?this.onerror(new Error(e),t):e.constructor==Error?this.onerror(e,t):this.onerror(new Error("An error occured"),t),this)},r.prototype.reset=function(e){this.dead||(this.state=i,this.buffers=[],this.messageEnd=-1,this.spanLength=0)}}).call(this,e("buffer").Buffer)},{buffer:4,util:void 0}],21:[function(e,t,n){(function(n){function r(e,t){if(this instanceof r==0)throw new TypeError("Classes can't be function-called");"number"==typeof e&&(t=e,e={});var i=-1;this.fragmentedBufferPool=new l(1024,(function(e,t){return e.used+t}),(function(e){return i=i>=0?Math.ceil((i+e.used)/2):e.used}));var o=-1;this.unfragmentedBufferPool=new l(1024,(function(e,t){return e.used+t}),(function(e){return o=o>=0?Math.ceil((o+e.used)/2):e.used})),this.extensions=e||{},this.maxPayload=t||0,this.currentPayloadLength=0,this.state={activeFragmentedOperation:null,lastFragment:!1,masked:!1,opcode:0,fragmentedOperation:!1},this.overflow=[],this.headerBuffer=new n(10),this.expectOffset=0,this.expectBuffer=null,this.expectHandler=null,this.currentMessage=[],this.currentMessageLength=0,this.messageHandlers=[],this.expectHeader(2,this.processPacket),this.dead=!1,this.processing=!1,this.onerror=function(){},this.ontext=function(){},this.onbinary=function(){},this.onclose=function(){},this.onping=function(){},this.onpong=function(){}}function i(e){return(this[e]<<8)+this[e+1]}function o(e){return(this[e]<<24)+(this[e+1]<<16)+(this[e+2]<<8)+this[e+3]}function s(e,t,n,r){switch(e){default:t.copy(n,r,0,e);break;case 16:n[r+15]=t[15];case 15:n[r+14]=t[14];case 14:n[r+13]=t[13];case 13:n[r+12]=t[12];case 12:n[r+11]=t[11];case 11:n[r+10]=t[10];case 10:n[r+9]=t[9];case 9:n[r+8]=t[8];case 8:n[r+7]=t[7];case 7:n[r+6]=t[6];case 6:n[r+5]=t[5];case 5:n[r+4]=t[4];case 4:n[r+3]=t[3];case 3:n[r+2]=t[2];case 2:n[r+1]=t[1];case 1:n[r]=t[0]}}function a(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var u=(e("util"),e("./Validation").Validation),c=e("./ErrorCodes"),l=e("./BufferPool"),f=e("./BufferUtil").BufferUtil,h=e("./PerMessageDeflate");t.exports=r,r.prototype.add=function(e){if(!this.dead){var t=e.length;if(0!=t){if(null==this.expectBuffer)return void this.overflow.push(e);var n=Math.min(t,this.expectBuffer.length-this.expectOffset);for(s(n,e,this.expectBuffer,this.expectOffset),this.expectOffset+=n,t>n&&this.overflow.push(e.slice(n));this.expectBuffer&&this.expectOffset==this.expectBuffer.length;){var r=this.expectBuffer;this.expectBuffer=null,this.expectOffset=0,this.expectHandler.call(this,r)}}}},r.prototype.cleanup=function(){this.dead=!0,this.overflow=null,this.headerBuffer=null,this.expectBuffer=null,this.expectHandler=null,this.unfragmentedBufferPool=null,this.fragmentedBufferPool=null,this.state=null,this.currentMessage=null,this.onerror=null,this.ontext=null,this.onbinary=null,this.onclose=null,this.onping=null,this.onpong=null},r.prototype.expectHeader=function(e,t){if(0!=e){this.expectBuffer=this.headerBuffer.slice(this.expectOffset,this.expectOffset+e),this.expectHandler=t;for(var n=e;n>0&&this.overflow.length>0;){var r=this.overflow.pop();n<r.length&&this.overflow.push(r.slice(n));var i=Math.min(r.length,n);s(i,r,this.expectBuffer,this.expectOffset),this.expectOffset+=i,n-=i}}else t(null)},r.prototype.expectData=function(e,t){if(0!=e){this.expectBuffer=this.allocateFromPool(e,this.state.fragmentedOperation),this.expectHandler=t;for(var n=e;n>0&&this.overflow.length>0;){var r=this.overflow.pop();n<r.length&&this.overflow.push(r.slice(n));var i=Math.min(r.length,n);s(i,r,this.expectBuffer,this.expectOffset),this.expectOffset+=i,n-=i}}else t(null)},r.prototype.allocateFromPool=function(e,t){return(t?this.fragmentedBufferPool:this.unfragmentedBufferPool).get(e)},r.prototype.processPacket=function(e){if(this.extensions[h.extensionName]){if(0!=(48&e[0]))return void this.error("reserved fields (2, 3) must be empty",1002)}else if(0!=(112&e[0]))return void this.error("reserved fields must be empty",1002);this.state.lastFragment=128==(128&e[0]),this.state.masked=128==(128&e[1]);var t=64==(64&e[0]),n=15&e[0];if(0===n){if(t)return void this.error("continuation frame cannot have the Per-message Compressed bits",1002);if(this.state.fragmentedOperation=!0,this.state.opcode=this.state.activeFragmentedOperation,1!=this.state.opcode&&2!=this.state.opcode)return void this.error("continuation frame cannot follow current opcode",1002)}else{if(3>n&&null!=this.state.activeFragmentedOperation)return void this.error("data frames after the initial data frame must have opcode 0",1002);if(n>=8&&t)return void this.error("control frames cannot have the Per-message Compressed bits",1002);this.state.compressed=t,this.state.opcode=n,!1===this.state.lastFragment?(this.state.fragmentedOperation=!0,this.state.activeFragmentedOperation=n):this.state.fragmentedOperation=!1}var r=p[this.state.opcode];"undefined"==typeof r?this.error("no handler for opcode "+this.state.opcode,1002):r.start.call(this,e)},r.prototype.endPacket=function(){this.dead||(this.state.fragmentedOperation?this.state.lastFragment&&this.fragmentedBufferPool.reset(!0):this.unfragmentedBufferPool.reset(!0),this.expectOffset=0,this.expectBuffer=null,this.expectHandler=null,this.state.lastFragment&&this.state.opcode===this.state.activeFragmentedOperation&&(this.state.activeFragmentedOperation=null),this.currentPayloadLength=0,this.state.lastFragment=!1,this.state.opcode=null!=this.state.activeFragmentedOperation?this.state.activeFragmentedOperation:0,this.state.masked=!1,this.expectHeader(2,this.processPacket))},r.prototype.reset=function(){this.dead||(this.state={activeFragmentedOperation:null,lastFragment:!1,masked:!1,opcode:0,fragmentedOperation:!1},this.fragmentedBufferPool.reset(!0),this.unfragmentedBufferPool.reset(!0),this.expectOffset=0,this.expectBuffer=null,this.expectHandler=null,this.overflow=[],this.currentMessage=[],this.currentMessageLength=0,this.messageHandlers=[],this.currentPayloadLength=0)},r.prototype.unmask=function(e,t,n){return null!=e&&null!=t&&f.unmask(t,e),n?t:null!=t?t.toString("utf8"):""},r.prototype.error=function(e,t){return this.dead?void 0:(this.reset(),"string"==typeof e?this.onerror(new Error(e),t):e.constructor==Error?this.onerror(e,t):this.onerror(new Error("An error occured"),t),this)},r.prototype.flush=function(){if(!this.processing&&!this.dead){var e=this.messageHandlers.shift();if(e){this.processing=!0;var t=this;e((function(){t.processing=!1,t.flush()}))}}},r.prototype.applyExtensions=function(e,t,n,r){var i=this;n?this.extensions[h.extensionName].decompress(e,t,(function(e,t){return i.dead?void 0:e?void r(new Error("invalid compressed data")):void r(null,t)})):r(null,e)},r.prototype.maxPayloadExceeded=function(e){if(void 0===this.maxPayload||null===this.maxPayload||this.maxPayload<1)return!1;var t=this.currentPayloadLength+e;return t<this.maxPayload?(this.currentPayloadLength=t,!1):(this.error("payload cannot exceed "+this.maxPayload+" bytes",1009),this.messageBuffer=[],this.cleanup(),!0)};var p={1:{start:function(e){var t=this,n=127&e[1];if(126>n){if(t.maxPayloadExceeded(n))return void t.error("Maximumpayload exceeded in compressed text message. Aborting...",1009);p[1].getData.call(t,n)}else 126==n?t.expectHeader(2,(function(e){var n=i.call(e,0);return t.maxPayloadExceeded(n)?void t.error("Maximumpayload exceeded in compressed text message. Aborting...",1009):void p[1].getData.call(t,n)})):127==n&&t.expectHeader(8,(function(e){if(0==o.call(e,0)){var n=o.call(e,4);return t.maxPayloadExceeded(n)?void t.error("Maximumpayload exceeded in compressed text message. Aborting...",1009):void p[1].getData.call(t,o.call(e,4))}t.error("packets with length spanning more than 32 bit is currently not supported",1008)}))},getData:function(e){var t=this;t.state.masked?t.expectHeader(4,(function(n){var r=n;t.expectData(e,(function(e){p[1].finish.call(t,r,e)}))})):t.expectData(e,(function(e){p[1].finish.call(t,null,e)}))},finish:function(e,t){var r=this,i=this.unmask(e,t,!0)||new n(0),o=a(this.state);this.messageHandlers.push((function(e){r.applyExtensions(i,o.lastFragment,o.compressed,(function(t,i){if(t)return 1009===t.type?r.error("Maximumpayload exceeded in compressed text message. Aborting...",1009):r.error(t.message,1007);if(null!=i){if(!(0==r.maxPayload||r.maxPayload>0&&r.currentMessageLength+i.length<r.maxPayload))return r.currentMessage=null,r.currentMessage=[],r.currentMessageLength=0,void r.error(new Error("Maximum payload exceeded. maxPayload: "+r.maxPayload),1009);r.currentMessage.push(i),r.currentMessageLength+=i.length}if(o.lastFragment){var s=n.concat(r.currentMessage);if(r.currentMessage=[],r.currentMessageLength=0,!u.isValidUTF8(s))return void r.error("invalid utf8 sequence",1007);r.ontext(s.toString("utf8"),{masked:o.masked,buffer:s})}e()}))})),this.flush(),this.endPacket()}},2:{start:function(e){var t=this,n=127&e[1];if(126>n){if(t.maxPayloadExceeded(n))return void t.error("Max payload exceeded in compressed text message. Aborting...",1009);p[2].getData.call(t,n)}else 126==n?t.expectHeader(2,(function(e){var n=i.call(e,0);return t.maxPayloadExceeded(n)?void t.error("Max payload exceeded in compressed text message. Aborting...",1009):void p[2].getData.call(t,n)})):127==n&&t.expectHeader(8,(function(e){if(0==o.call(e,0)){var n=o.call(e,4,!0);return t.maxPayloadExceeded(n)?void t.error("Max payload exceeded in compressed text message. Aborting...",1009):void p[2].getData.call(t,n)}t.error("packets with length spanning more than 32 bit is currently not supported",1008)}))},getData:function(e){var t=this;t.state.masked?t.expectHeader(4,(function(n){var r=n;t.expectData(e,(function(e){p[2].finish.call(t,r,e)}))})):t.expectData(e,(function(e){p[2].finish.call(t,null,e)}))},finish:function(e,t){var r=this,i=this.unmask(e,t,!0)||new n(0),o=a(this.state);this.messageHandlers.push((function(e){r.applyExtensions(i,o.lastFragment,o.compressed,(function(t,i){if(t)return 1009===t.type?r.error("Max payload exceeded in compressed binary message. Aborting...",1009):r.error(t.message,1007);if(null!=i){if(!(0==r.maxPayload||r.maxPayload>0&&r.currentMessageLength+i.length<r.maxPayload))return r.currentMessage=null,r.currentMessage=[],r.currentMessageLength=0,void r.error(new Error("Maximum payload exceeded"),1009);r.currentMessage.push(i),r.currentMessageLength+=i.length}if(o.lastFragment){var s=n.concat(r.currentMessage);r.currentMessage=[],r.currentMessageLength=0,r.onbinary(s,{masked:o.masked,buffer:s})}e()}))})),this.flush(),this.endPacket()}},8:{start:function(e){var t=this;if(0!=t.state.lastFragment){var n=127&e[1];126>n?p[8].getData.call(t,n):t.error("control frames cannot have more than 125 bytes of data",1002)}else t.error("fragmented close is not supported",1002)},getData:function(e){var t=this;t.state.masked?t.expectHeader(4,(function(n){var r=n;t.expectData(e,(function(e){p[8].finish.call(t,r,e)}))})):t.expectData(e,(function(e){p[8].finish.call(t,null,e)}))},finish:function(e,t){var n=this;t=n.unmask(e,t,!0);var r=a(this.state);this.messageHandlers.push((function(){if(t&&1==t.length)n.error("close packets with data must be at least two bytes long",1002);else{var e=t&&t.length>1?i.call(t,0):1e3;if(c.isValidErrorCode(e)){var o="";if(t&&t.length>2){var s=t.slice(2);if(!u.isValidUTF8(s))return void n.error("invalid utf8 sequence",1007);o=s.toString("utf8")}n.onclose(e,o,{masked:r.masked}),n.reset()}else n.error("invalid error code",1002)}})),this.flush()}},9:{start:function(e){var t=this;if(0!=t.state.lastFragment){var n=127&e[1];126>n?p[9].getData.call(t,n):t.error("control frames cannot have more than 125 bytes of data",1002)}else t.error("fragmented ping is not supported",1002)},getData:function(e){var t=this;t.state.masked?t.expectHeader(4,(function(n){var r=n;t.expectData(e,(function(e){p[9].finish.call(t,r,e)}))})):t.expectData(e,(function(e){p[9].finish.call(t,null,e)}))},finish:function(e,t){var n=this;t=this.unmask(e,t,!0);var r=a(this.state);this.messageHandlers.push((function(e){n.onping(t,{masked:r.masked,binary:!0}),e()})),this.flush(),this.endPacket()}},10:{start:function(e){var t=this;if(0!=t.state.lastFragment){var n=127&e[1];126>n?p[10].getData.call(t,n):t.error("control frames cannot have more than 125 bytes of data",1002)}else t.error("fragmented pong is not supported",1002)},getData:function(e){var t=this;this.state.masked?this.expectHeader(4,(function(n){var r=n;t.expectData(e,(function(e){p[10].finish.call(t,r,e)}))})):this.expectData(e,(function(e){p[10].finish.call(t,null,e)}))},finish:function(e,t){var n=this;t=n.unmask(e,t,!0);var r=a(this.state);this.messageHandlers.push((function(e){n.onpong(t,{masked:r.masked,binary:!0}),e()})),this.flush(),this.endPacket()}}}}).call(this,e("buffer").Buffer)},{"./BufferPool":14,"./BufferUtil":16,"./ErrorCodes":17,"./PerMessageDeflate":19,"./Validation":25,buffer:4,util:void 0}],22:[function(e,t,n){(function(n){function r(e){if(this instanceof r==0)throw new TypeError("Classes can't be function-called");i.EventEmitter.call(this),this.socket=e,this.continuationFrame=!1,this.isClosed=!1}var i=e("events"),o=e("util");i.EventEmitter,t.exports=r,o.inherits(r,i.EventEmitter),r.prototype.send=function(e,t,r){if(!this.isClosed){var i="string"==typeof e,o=i?n.byteLength(e):e.length,s=o>127?2:1,a=0==this.continuationFrame,u=!t||!("undefined"!=typeof t.fin&&!t.fin),c=new n((a?t&&t.binary?1+s:1:0)+o+(!u||t&&t.binary?0:1)),l=a?1:0;a&&(t&&t.binary?(c.write("\x80","binary"),s>1&&c.write(String.fromCharCode(128+o/128),l++,"binary"),c.write(String.fromCharCode(127&o),l++,"binary")):c.write("\0","binary")),i?c.write(e,l,"utf8"):e.copy(c,l,0),u?(t&&t.binary||c.write("\xff",l+o,"binary"),this.continuationFrame=!1):this.continuationFrame=!0;try{this.socket.write(c,"binary",r)}catch(f){this.error(f.toString())}}},r.prototype.close=function(e,t,r,i){if(!this.isClosed){this.isClosed=!0;try{this.continuationFrame&&this.socket.write(new n([255],"binary")),this.socket.write(new n([255,0]),"binary",i)}catch(o){this.error(o.toString())}}},r.prototype.ping=function(e,t){},r.prototype.pong=function(e,t){},r.prototype.error=function(e){return this.emit("error",e),this}}).call(this,e("buffer").Buffer)},{buffer:4,events:void 0,util:void 0}],23:[function(e,t,n){(function(n){function r(e,t){if(this instanceof r==0)throw new TypeError("Classes can't be function-called");a.EventEmitter.call(this),this._socket=e,this.extensions=t||{},this.firstFragment=!0,this.compress=!1,this.messageHandlers=[],this.processing=!1}function i(e,t){this[t]=(65280&e)>>8,this[t+1]=255&e}function o(e,t){this[t]=(4278190080&e)>>24,this[t+1]=(16711680&e)>>16,this[t+2]=(65280&e)>>8,this[t+3]=255&e}function s(e){for(var t=new Uint8Array(e.buffer||e),r=e.byteLength||e.length,i=e.byteOffset||0,o=new n(r),s=0;r>s;++s)o[s]=t[i+s];return o}var a=e("events"),u=e("util"),c=(a.EventEmitter,e("./ErrorCodes")),l=e("./BufferUtil").BufferUtil,f=e("./PerMessageDeflate");u.inherits(r,a.EventEmitter),r.prototype.close=function(e,t,r,o){if("undefined"!=typeof e&&("number"!=typeof e||!c.isValidErrorCode(e)))throw new Error("first argument must be a valid error code number");e=e||1e3;var s=new n(2+(t?n.byteLength(t):0));i.call(s,e,0),s.length>2&&s.write(t,2);var a=this;this.messageHandlers.push((function(e){a.frameAndSend(8,s,!0,r),e(),"function"==typeof o&&o()})),this.flush()},r.prototype.ping=function(e,t){var n=t&&t.mask,r=this;this.messageHandlers.push((function(t){r.frameAndSend(9,e||"",!0,n),t()})),this.flush()},r.prototype.pong=function(e,t){var n=t&&t.mask,r=this;this.messageHandlers.push((function(t){r.frameAndSend(10,e||"",!0,n),t()})),this.flush()},r.prototype.send=function(e,t,n){var r=!t||!1!==t.fin,i=t&&t.mask,o=t&&t.compress,s=t&&t.binary?2:1;!1===this.firstFragment?(s=0,o=!1):(this.firstFragment=!1,this.compress=o),r&&(this.firstFragment=!0);var a=this.compress,u=this;this.messageHandlers.push((function(t){u.applyExtensions(e,r,a,(function(e,a){return e?void("function"==typeof n?n(e):u.emit("error",e)):(u.frameAndSend(s,a,r,i,o,n),void t())}))})),this.flush()},r.prototype.frameAndSend=function(e,t,r,a,u,c){var f=!1;if(t){n.isBuffer(t)||(f=!0,!t||"undefined"==typeof t.byteLength&&"undefined"==typeof t.buffer?("number"==typeof t&&(t=t.toString()),t=new n(t)):t=s(t));var h=t.length,p=a?6:2,d=h;h>=65536?(p+=8,d=127):h>125&&(p+=2,d=126);var v=32768>h||a&&!f,y=new n(v?h+p:p);switch(y[0]=r?128|e:e,u&&(y[0]|=64),d){case 126:i.call(y,h,2);break;case 127:o.call(y,0,2),o.call(y,h,6)}if(a){y[1]=128|d;var m=new n([~~(255*Math.random()),~~(255*Math.random()),~~(255*Math.random()),~~(255*Math.random())]);if(y[p-4]=m[0],y[p-3]=m[1],y[p-2]=m[2],y[p-1]=m[3],v){l.mask(t,m,y,p,h);try{this._socket.write(y,"binary",c)}catch(g){"function"==typeof c?c(g):this.emit("error",g)}}else{l.mask(t,m,t,0,h);try{this._socket.write(y,"binary"),this._socket.write(t,"binary",c)}catch(g){"function"==typeof c?c(g):this.emit("error",g)}}}else if(y[1]=d,v){t.copy(y,p);try{this._socket.write(y,"binary",c)}catch(g){"function"==typeof c?c(g):this.emit("error",g)}}else try{this._socket.write(y,"binary"),this._socket.write(t,"binary",c)}catch(g){"function"==typeof c?c(g):this.emit("error",g)}}else try{this._socket.write(new n([e|(r?128:0),0|(a?128:0)].concat(a?[0,0,0,0]:[])),"binary",c)}catch(g){"function"==typeof c?c(g):this.emit("error",g)}},r.prototype.flush=function(){if(!this.processing){var e=this.messageHandlers.shift();if(e){this.processing=!0;var t=this;e((function(){t.processing=!1,t.flush()}))}}},r.prototype.applyExtensions=function(e,t,n,r){n&&e?((e.buffer||e)instanceof ArrayBuffer&&(e=s(e)),this.extensions[f.extensionName].compress(e,t,r)):r(null,e)},t.exports=r}).call(this,e("buffer").Buffer)},{"./BufferUtil":16,"./ErrorCodes":17,"./PerMessageDeflate":19,buffer:4,events:void 0,util:void 0}],24:[function(e,t,n){n.Validation={isValidUTF8:function(e){return!0}}},{}],25:[function(e,t,n){"use strict";try{t.exports=e("utf-8-validate")}catch(r){t.exports=e("./Validation.fallback")}},{"./Validation.fallback":24,"utf-8-validate":12}],26:[function(e,t,n){(function(n,r){"use strict";function i(e,t,n){return this instanceof i==0?new i(e,t,n):(R.call(this),t&&!Array.isArray(t)&&"object"==typeof t&&(n=t,t=null),"string"==typeof t&&(t=[t]),Array.isArray(t)||(t=[]),this._socket=null,this._ultron=null,this._closeReceived=!1,this.bytesReceived=0,this.readyState=null,this.supports={},this.extensions={},this._binaryType="nodebuffer",void(Array.isArray(e)?c.apply(this,e.concat(n)):l.apply(this,[e,t,n])))}function o(e,t,n){this.type="message",this.data=e,this.target=n,this.binary=t}function s(e,t,n){this.type="close",this.wasClean="undefined"==typeof e||1e3===e,this.code=e,this.reason=t,this.target=n}function a(e){this.type="open",this.target=e}function u(e,t,n){var r=t;return t&&(e&&443!=n||!e&&80!=n)&&(r=r+":"+n),r}function c(e,t,n,r){r=new E({protocolVersion:T,protocol:null,extensions:{},maxPayload:0}).merge(r),this.protocol=r.value.protocol,this.protocolVersion=r.value.protocolVersion,this.extensions=r.value.extensions,this.supports.binary="hixie-76"!==this.protocolVersion,this.upgradeReq=e,this.readyState=i.CONNECTING,this._isServer=!0,this.maxPayload=r.value.maxPayload,"hixie-76"===r.value.protocolVersion?f.call(this,k,x,t,n):f.call(this,O,S,t,n)}function l(e,t,n){if(8!==(n=new E({origin:null,protocolVersion:T,host:null,headers:null,protocol:t.join(","),agent:null,pfx:null,key:null,passphrase:null,cert:null,ca:null,ciphers:null,rejectUnauthorized:null,perMessageDeflate:!0,localAddress:null}).merge(n)).value.protocolVersion&&13!==n.value.protocolVersion)throw new Error("unsupported protocol version");var o=v.parse(e),s="ws+unix:"===o.protocol;if(!o.host&&!s)throw new Error("invalid url");var a,c="wss:"===o.protocol||"https:"===o.protocol,l=c?g:m,h=o.port||(c?443:80),p=o.auth,y={};n.value.perMessageDeflate&&(a=new C(!0!==typeof n.value.perMessageDeflate?n.value.perMessageDeflate:{},!1),y[C.extensionName]=a.offer()),this._isServer=!1,this.url=e,this.protocolVersion=n.value.protocolVersion,this.supports.binary="hixie-76"!==this.protocolVersion;var w=new r(n.value.protocolVersion+"-"+Date.now()).toString("base64"),b=_.createHash("sha1");b.update(w+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11");var x=b.digest("base64"),k=n.value.agent,R=u(c,o.hostname,h),N={port:h,host:o.hostname,headers:{Connection:"Upgrade",Upgrade:"websocket",Host:R,"Sec-WebSocket-Version":n.value.protocolVersion,"Sec-WebSocket-Key":w}};if(p&&(N.headers.Authorization="Basic "+new r(p).toString("base64")),n.value.protocol&&(N.headers["Sec-WebSocket-Protocol"]=n.value.protocol),n.value.host&&(N.headers.Host=n.value.host),n.value.headers)for(var A in n.value.headers)n.value.headers.hasOwnProperty(A)&&(N.headers[A]=n.value.headers[A]);Object.keys(y).length&&(N.headers["Sec-WebSocket-Extensions"]=P.format(y)),(n.isDefinedAndNonNull("pfx")||n.isDefinedAndNonNull("key")||n.isDefinedAndNonNull("passphrase")||n.isDefinedAndNonNull("cert")||n.isDefinedAndNonNull("ca")||n.isDefinedAndNonNull("ciphers")||n.isDefinedAndNonNull("rejectUnauthorized"))&&(n.isDefinedAndNonNull("pfx")&&(N.pfx=n.value.pfx),n.isDefinedAndNonNull("key")&&(N.key=n.value.key),n.isDefinedAndNonNull("passphrase")&&(N.passphrase=n.value.passphrase),n.isDefinedAndNonNull("cert")&&(N.cert=n.value.cert),n.isDefinedAndNonNull("ca")&&(N.ca=n.value.ca),n.isDefinedAndNonNull("ciphers")&&(N.ciphers=n.value.ciphers),n.isDefinedAndNonNull("rejectUnauthorized")&&(N.rejectUnauthorized=n.value.rejectUnauthorized),k||(k=new l.Agent(N))),N.path=o.path||"/",k&&(N.agent=k),s&&(N.socketPath=o.pathname),n.value.localAddress&&(N.localAddress=n.value.localAddress),n.value.origin&&(n.value.protocolVersion<13?N.headers["Sec-WebSocket-Origin"]=n.value.origin:N.headers.Origin=n.value.origin);var L=this,U=l.request(N);U.on("error",(function(e){L.emit("error",e),d.call(L,e)})),U.once("response",(function(e){var t;L.emit("unexpected-response",U,e)||(t=new Error("unexpected server response ("+e.statusCode+")"),U.abort(),L.emit("error",t)),d.call(L,t)})),U.once("upgrade",(function(e,t,r){if(L.readyState===i.CLOSED)return L.emit("close"),L.removeAllListeners(),void t.end();var o=e.headers["sec-websocket-accept"];if("undefined"==typeof o||o!==x)return L.emit("error","invalid server key"),L.removeAllListeners(),void t.end();var s=e.headers["sec-websocket-protocol"],u=(n.value.protocol||"").split(/, */),c=null;if(!n.value.protocol&&s?c="server sent a subprotocol even though none requested":n.value.protocol&&!s?c="server sent no subprotocol even though requested":s&&-1===u.indexOf(s)&&(c="server responded with an invalid protocol"),c)return L.emit("error",c),L.removeAllListeners(),void t.end();s&&(L.protocol=s);var l=P.parse(e.headers["sec-websocket-extensions"]);if(a&&l[C.extensionName]){try{a.accept(l[C.extensionName])}catch(h){return L.emit("error","invalid extension parameter"),L.removeAllListeners(),void t.end()}L.extensions[C.extensionName]=a}f.call(L,O,S,t,r),U.removeAllListeners(),U=null,k=null})),U.end(),this.readyState=i.CONNECTING}function f(e,t,r,o){function s(e){c||l.readyState===i.CLOSED||(c=!0,r.removeListener("data",s),u.on("data",a),o&&o.length>0&&(a(o),o=null),e&&a(e))}function a(e){l.bytesReceived+=e.length,l._receiver.add(e)}var u=this._ultron=new b(r),c=!1,l=this;r.setTimeout(0),r.setNoDelay(!0),this._receiver=new e(this.extensions,this.maxPayload),this._socket=r,u.on("end",d.bind(this)),u.on("close",d.bind(this)),u.on("error",d.bind(this)),u.on("data",s),n.nextTick(s),l._receiver.ontext=function(e,t){t=t||{},l.emit("message",e,t)},l._receiver.onbinary=function(e,t){(t=t||{}).binary=!0,l.emit("message",e,t)},l._receiver.onping=function(e,t){t=t||{},l.pong(e,{mask:!l._isServer,binary:!0===t.binary},!0),l.emit("ping",e,t)},l._receiver.onpong=function(e,t){l.emit("pong",e,t||{})},l._receiver.onclose=function(e,t,n){n=n||{},l._closeReceived=!0,l.close(e,t)},l._receiver.onerror=function(e,t){l.close("undefined"!=typeof t?t:1002,""),l.emit("error",e instanceof Error?e:new Error(e))},this._sender=new t(r,this.extensions),this._sender.on("error",(function(e){l.close(1002,""),l.emit("error",e)})),this.readyState=i.OPEN,this.emit("open")}function h(e){e._queue=e._queue||[]}function p(e){var t=e._queue;if("undefined"!=typeof t){delete e._queue;for(var n=0,r=t.length;r>n;++n)t[n]()}}function d(e){if(this.readyState!==i.CLOSED){if(this.readyState=i.CLOSED,clearTimeout(this._closeTimer),this._closeTimer=null,!e&&this._closeReceived||(this._closeCode=1006),this.emit("close",this._closeCode||1e3,this._closeMessage||""),this._socket){this._ultron&&this._ultron.destroy(),this._socket.on("error",(function(){try{this.destroy()}catch(e){}}));try{e?this._socket.destroy():this._socket.end()}catch(t){}this._socket=null,this._ultron=null}this._sender&&(this._sender.removeAllListeners(),this._sender=null),this._receiver&&(this._receiver.cleanup(),this._receiver=null),this.extensions[C.extensionName]&&this.extensions[C.extensionName].cleanup(),this.extensions=null,this.removeAllListeners(),this.on("error",(function(){})),delete this._queue}}var v=e("url"),y=e("util"),m=e("http"),g=e("https"),_=e("crypto"),w=e("stream"),b=e("ultron"),E=e("options"),S=e("./Sender"),O=e("./Receiver"),x=e("./Sender.hixie"),k=e("./Receiver.hixie"),P=e("./Extensions"),C=e("./PerMessageDeflate"),R=e("events").EventEmitter,T=13;y.inherits(i,R),["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e,t){i.prototype[e]=i[e]=t})),i.prototype.close=function(e,t){if(this.readyState!==i.CLOSED){if(this.readyState===i.CONNECTING)return void(this.readyState=i.CLOSED);if(this.readyState===i.CLOSING)return void(this._closeReceived&&this._isServer&&this.terminate());var n=this;try{this.readyState=i.CLOSING,this._closeCode=e,this._closeMessage=t;var r=!this._isServer;this._sender.close(e,t,r,(function(e){e&&n.emit("error",e),n._closeReceived&&n._isServer?n.terminate():(clearTimeout(n._closeTimer),n._closeTimer=setTimeout(d.bind(n,!0),3e4))}))}catch(o){this.emit("error",o)}}},i.prototype.pause=function(){if(this.readyState!==i.OPEN)throw new Error("not opened");return this._socket.pause()},i.prototype.ping=function(e,t,n){if(this.readyState!==i.OPEN){if(!0===n)return;throw new Error("not opened")}"undefined"==typeof(t=t||{}).mask&&(t.mask=!this._isServer),this._sender.ping(e,t)},i.prototype.pong=function(e,t,n){if(this.readyState!==i.OPEN){if(!0===n)return;throw new Error("not opened")}"undefined"==typeof(t=t||{}).mask&&(t.mask=!this._isServer),this._sender.pong(e,t)},i.prototype.resume=function(){if(this.readyState!==i.OPEN)throw new Error("not opened");return this._socket.resume()},i.prototype.send=function(e,t,o){if("function"==typeof t&&(o=t,t={}),this.readyState===i.OPEN)if(e||(e=""),this._queue){var s=this;this._queue.push((function(){s.send(e,t,o)}))}else{(t=t||{}).fin=!0,"undefined"==typeof t.binary&&(t.binary=e instanceof ArrayBuffer||e instanceof r||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array),"undefined"==typeof t.mask&&(t.mask=!this._isServer),"undefined"==typeof t.compress&&(t.compress=!0),this.extensions[C.extensionName]||(t.compress=!1);var a="function"==typeof w.Readable?w.Readable:w.Stream;e instanceof a?(h(this),s=this,function(e,t,n,r){t.on("data",(function(t){return e.readyState!==i.OPEN?void("function"==typeof r?r(new Error("not opened")):(delete e._queue,e.emit("error",new Error("not opened")))):(n.fin=!1,void e._sender.send(t,n))})),t.on("end",(function(){return e.readyState!==i.OPEN?void("function"==typeof r?r(new Error("not opened")):(delete e._queue,e.emit("error",new Error("not opened")))):(n.fin=!0,e._sender.send(null,n),void("function"==typeof r&&r(null)))}))}(this,e,t,(function(e){n.nextTick((function(){p(s)})),"function"==typeof o&&o(e)}))):this._sender.send(e,t,o)}else{if("function"!=typeof o)throw new Error("not opened");o(new Error("not opened"))}},i.prototype.stream=function(e,t){"function"==typeof e&&(t=e,e={});var r=this;if("function"!=typeof t)throw new Error("callback must be provided");if(this.readyState===i.OPEN)return this._queue?void this._queue.push((function(){r.stream(e,t)})):("undefined"==typeof(e=e||{}).mask&&(e.mask=!this._isServer),"undefined"==typeof e.compress&&(e.compress=!0),this.extensions[C.extensionName]||(e.compress=!1),h(this),void n.nextTick(t.bind(null,null,(function o(s,a){try{if(r.readyState!==i.OPEN)throw new Error("not opened");e.fin=!0===a,r._sender.send(s,e),a?p(r):n.nextTick(t.bind(null,null,o))}catch(u){"function"==typeof t?t(u):(delete r._queue,r.emit("error",u))}}))));if("function"!=typeof t)throw new Error("not opened");t(new Error("not opened"))},i.prototype.terminate=function(){if(this.readyState!==i.CLOSED)if(this._socket){this.readyState=i.CLOSING;try{this._socket.end()}catch(e){return void d.call(this,!0)}this._closeTimer&&clearTimeout(this._closeTimer),this._closeTimer=setTimeout(d.bind(this,!0),3e4)}else this.readyState===i.CONNECTING&&d.call(this,!0)},Object.defineProperty(i.prototype,"bufferedAmount",{get:function(){var e=0;return this._socket&&(e=this._socket.bufferSize||0),e}}),Object.defineProperty(i.prototype,"binaryType",{get:function(){return this._binaryType},set:function(e){if("arraybuffer"!==e&&"nodebuffer"!==e)throw new SyntaxError('unsupported binaryType: must be either "nodebuffer" or "arraybuffer"');this._binaryType=e}}),["open","error","close","message"].forEach((function(e){Object.defineProperty(i.prototype,"on"+e,{get:function(){var t=this.listeners(e)[0];return t?t._listener?t._listener:t:void 0},set:function(t){this.removeAllListeners(e),this.addEventListener(e,t)}})})),i.prototype.addEventListener=function(e,t){function n(e,n){n.binary&&"arraybuffer"===this.binaryType&&(e=new Uint8Array(e).buffer),t.call(c,new o(e,!!n.binary,c))}function r(e,n){t.call(c,new s(e,n,c))}function i(e){e.type="error",e.target=c,t.call(c,e)}function u(){t.call(c,new a(c))}var c=this;"function"==typeof t&&("message"===e?(n._listener=t,this.on(e,n)):"close"===e?(r._listener=t,this.on(e,r)):"error"===e?(i._listener=t,this.on(e,i)):"open"===e?(u._listener=t,this.on(e,u)):this.on(e,t))},t.exports=i,t.exports.buildHostHeader=u}).call(this,e("_process"),e("buffer").Buffer)},{"./Extensions":18,"./PerMessageDeflate":19,"./Receiver":21,"./Receiver.hixie":20,"./Sender":23,"./Sender.hixie":22,_process:3,buffer:4,crypto:void 0,events:void 0,http:void 0,https:void 0,options:9,stream:void 0,ultron:10,url:void 0,util:void 0}],27:[function(e,t,n){(function(n){function r(e,t){if(this instanceof r==0)return new r(e,t);if(c.EventEmitter.call(this),!(e=new h({host:"0.0.0.0",port:null,server:null,verifyClient:null,handleProtocols:null,path:null,noServer:!1,disableHixie:!1,clientTracking:!0,perMessageDeflate:!0,maxPayload:104857600}).merge(e)).isDefinedAndNonNull("port")&&!e.isDefinedAndNonNull("server")&&!e.value.noServer)throw new TypeError("`port` or a `server` must be provided");var i=this;if(e.isDefinedAndNonNull("port"))this._server=l.createServer((function(e,t){var n=l.STATUS_CODES[426];t.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),t.end(n)})),this._server.allowHalfOpen=!1,this._server.listen(e.value.port,e.value.host,t),this._closeServer=function(){i._server&&i._server.close()};else if(e.value.server&&(this._server=e.value.server,e.value.path)){if(this._server._webSocketPaths&&e.value.server._webSocketPaths[e.value.path])throw new Error("two instances of WebSocketServer cannot listen on the same http server path");"object"!=typeof this._server._webSocketPaths&&(this._server._webSocketPaths={}),this._server._webSocketPaths[e.value.path]=1}this._server&&(this._onceServerListening=function(){i.emit("listening")},this._server.once("listening",this._onceServerListening)),"undefined"!=typeof this._server&&(this._onServerError=function(e){i.emit("error",e)},this._server.on("error",this._onServerError),this._onServerUpgrade=function(e,t,r){var o=new n(r.length);r.copy(o),i.handleUpgrade(e,t,o,(function(t){i.emit("connection"+e.url,t),i.emit("connection",t)}))},this._server.on("upgrade",this._onServerUpgrade)),this.options=e.value,this.path=e.value.path,this.clients=[]}function i(e,t,n,r){var i=function(){try{t.destroy()}catch(e){}};if(t.on("error",i),e.headers["sec-websocket-key"]){var o=parseInt(e.headers["sec-websocket-version"]);if(-1!==[8,13].indexOf(o)){var u=e.headers["sec-websocket-protocol"],c=13>o?e.headers["sec-websocket-origin"]:e.headers.origin,h=d.parse(e.headers["sec-websocket-extensions"]),v=this,y=function(u){var c=e.headers["sec-websocket-key"],l=f.createHash("sha1");l.update(c+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11");var y=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade","Sec-WebSocket-Accept: "+(c=l.digest("base64"))];"undefined"!=typeof u&&y.push("Sec-WebSocket-Protocol: "+u);var m={};try{m=s.call(v,h)}catch(g){return void a(t,400,"Bad Request")}if(Object.keys(m).length){var _={};Object.keys(m).forEach((function(e){_[e]=[m[e].params]})),y.push("Sec-WebSocket-Extensions: "+d.format(_))}v.emit("headers",y),t.setTimeout(0),t.setNoDelay(!0);try{t.write(y.concat("","").join("\r\n"))}catch(b){try{t.destroy()}catch(b){}return}var w=new p([e,t,n],{protocolVersion:o,protocol:u,extensions:m,maxPayload:v.options.maxPayload});v.options.clientTracking&&(v.clients.push(w),w.on("close",(function(){var e=v.clients.indexOf(w);-1!=e&&v.clients.splice(e,1)}))),t.removeListener("error",i),r(w)},m=function(){if("function"==typeof v.options.handleProtocols){var e=(u||"").split(/, */),n=!1;return v.options.handleProtocols(e,(function(e,r){n=!0,e?y(r):a(t,401,"Unauthorized")})),void(n||a(t,501,"Could not process protocols"))}"undefined"!=typeof u?y(u.split(/, */)[0]):y()};if("function"==typeof this.options.verifyClient){var g={origin:c,secure:"undefined"!=typeof e.connection.authorized||"undefined"!=typeof e.connection.encrypted,req:e};if(2==this.options.verifyClient.length)return void this.options.verifyClient(g,(function(e,n,r){"undefined"==typeof n&&(n=401),"undefined"==typeof r&&(r=l.STATUS_CODES[n]),e?m():a(t,n,r)}));if(!this.options.verifyClient(g))return void a(t,401,"Unauthorized")}m()}else a(t,400,"Bad Request")}else a(t,400,"Bad Request")}function o(e,t,r,i){var o=function(){try{t.destroy()}catch(e){}};if(t.on("error",o),this.options.disableHixie)a(t,401,"Hixie support disabled");else if(e.headers["sec-websocket-key2"]){var s=e.headers.origin,u=this,c=function(){var c;c=e.headers["x-forwarded-host"]?e.headers["x-forwarded-host"]:e.headers.host;var l=("https"===e.headers["x-forwarded-proto"]||t.encrypted?"wss":"ws")+"://"+c+e.url,h=e.headers["sec-websocket-protocol"],d=function(){var e=["HTTP/1.1 101 Switching Protocols","Upgrade: WebSocket","Connection: Upgrade","Sec-WebSocket-Location: "+l];return"undefined"!=typeof h&&e.push("Sec-WebSocket-Protocol: "+h),"undefined"!=typeof s&&e.push("Sec-WebSocket-Origin: "+s),new n(e.concat("","").join("\r\n"))},v=function(r,s,c){var l=e.headers["sec-websocket-key1"],d=e.headers["sec-websocket-key2"],v=f.createHash("md5");[l,d].forEach((function(e){var n=parseInt(e.replace(/[^\d]/g,"")),r=e.replace(/[^ ]/g,"").length;return 0===r||n%r!==0?void a(t,400,"Bad Request"):(n/=r,void v.update(String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,255&n)))})),v.update(r.toString("binary")),t.setTimeout(0),t.setNoDelay(!0);try{var m=new n(v.digest("binary"),"binary"),g=new n(c.length+m.length);c.copy(g,0),m.copy(g,c.length),t.write(g,"binary",(function(n){if(!n){var r=new p([e,t,s],{protocolVersion:"hixie-76",protocol:h});u.options.clientTracking&&(u.clients.push(r),r.on("close",(function(){var e=u.clients.indexOf(r);-1!=e&&u.clients.splice(e,1)}))),t.removeListener("error",o),i(r)}}))}catch(y){try{t.destroy()}catch(y){}return}};if(r&&r.length>=8){var y=r.slice(0,8),m=r.length>8?r.slice(8):null;v.call(u,y,m,d())}else{y=new n(8),r.copy(y,0);var g=r.length,_=(m=null,function e(r){var i=Math.min(r.length,8-g);0!==i&&(r.copy(y,g,0,i),8==(g+=i)&&(t.removeListener("data",e),i<r.length&&(m=r.slice(i)),v.call(u,y,m,new n(0))))});t.on("data",_),function(){t.setTimeout(0),t.setNoDelay(!0);var e=d();try{t.write(e,"binary",(function(e){e&&t.removeListener("data",_)}))}catch(n){try{t.destroy()}catch(n){}return}}()}};if("function"==typeof this.options.verifyClient){var h={origin:s,secure:"undefined"!=typeof e.connection.authorized||"undefined"!=typeof e.connection.encrypted,req:e};if(2==this.options.verifyClient.length)return u=this,void this.options.verifyClient(h,(function(e,n,r){"undefined"==typeof n&&(n=401),"undefined"==typeof r&&(r=l.STATUS_CODES[n]),e?c.apply(u):a(t,n,r)}));if(!this.options.verifyClient(h))return void a(t,401,"Unauthorized")}c()}else a(t,400,"Bad Request")}function s(e){var t={},n=this.options.perMessageDeflate,r=this.options.maxPayload;if(n&&e[v.extensionName]){var i=new v(!0!==n?n:{},!0,r);i.accept(e[v.extensionName]),t[v.extensionName]=i}return t}function a(e,t,n){try{var r=["HTTP/1.1 "+t+" "+n,"Content-type: text/html"];e.write(r.concat("","").join("\r\n"))}catch(i){}finally{try{e.destroy()}catch(i){}}}var u=e("util"),c=e("events"),l=e("http"),f=e("crypto"),h=e("options"),p=e("./WebSocket"),d=e("./Extensions"),v=e("./PerMessageDeflate"),y=(e("tls"),e("url"));u.inherits(r,c.EventEmitter),r.prototype.close=function(e){var t=null;try{for(var n=0,r=this.clients.length;r>n;++n)this.clients[n].terminate()}catch(i){t=i}this.path&&this._server._webSocketPaths&&(delete this._server._webSocketPaths[this.path],0==Object.keys(this._server._webSocketPaths).length&&delete this._server._webSocketPaths);try{"undefined"!=typeof this._closeServer&&this._closeServer()}finally{this._server&&(this._server.removeListener("listening",this._onceServerListening),this._server.removeListener("error",this._onServerError),this._server.removeListener("upgrade",this._onServerUpgrade)),delete this._server}if(e)e(t);else if(t)throw t},r.prototype.handleUpgrade=function(e,t,n,r){if(this.options.path){var s=y.parse(e.url);if(s&&s.pathname!==this.options.path)return}return"undefined"==typeof e.headers.upgrade||"websocket"!==e.headers.upgrade.toLowerCase()?void a(t,400,"Bad Request"):void(e.headers["sec-websocket-key1"]?o.apply(this,arguments):i.apply(this,arguments))},t.exports=r}).call(this,e("buffer").Buffer)},{"./Extensions":18,"./PerMessageDeflate":19,"./WebSocket":26,buffer:4,crypto:void 0,events:void 0,http:void 0,options:9,tls:void 0,url:void 0,util:void 0}],28:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SCBot=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./protocol"),o=e("./utils"),s=e("./httpRequest");n.SCBot=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.botId=t}return r(e,[{key:"send",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=i.BotProtocol.init(this.botId);n.setData(e);var r=new s.HttpRequest(n),a=r.execute();return o.Utils.wrapCallbacks(a,t)}}]),e}()},{"./httpRequest":32,"./protocol":40,"./utils":48}],29:[function(e,t,n){(function(t){"use strict";function r(e,t){this._bsontype="Timestamp",this.low_=0|e,this.high_=0|t}function i(){this._bsontype="MinKey"}function o(){this._bsontype="MaxKey"}Object.defineProperty(n,"__esModule",{value:!0});var s=9007199254740992,a=-9007199254740992,u=e("./long"),c=e("./objectid");r.prototype.getLowBits=function(){return this.low_},r.prototype.getHighBits=function(){return this.high_},n.deserializeFast=function e(n,l,f){if(n.length<5)return new Error("Corrupt bson message < 5 bytes long");var h,p,d,v,y=0;l||(l=0);var m=f?[]:{},g=n[l++]|n[l++]<<8|n[l++]<<16|n[l++]<<24;if(5>g||g>n.length)return new Error("Corrupt BSON message");for(;0!==(h=n[l++]);){for(y=l;0!==n[y];)y++;if(y>=n.length)return new Error("Corrupt BSON document: illegal CString");switch(p=n.toString("utf8",l,y),l=y+1,h){case 7:var _=new t(12);n.copy(_,0,l,l+=12),m[p]=new c(_);break;case 2:g=n[l++]|n[l++]<<8|n[l++]<<16|n[l++]<<24,m[p]=n.toString("utf8",l,l+=g-1),l++;break;case 16:m[p]=n[l++]|n[l++]<<8|n[l++]<<16|n[l++]<<24;break;case 1:m[p]=n.readDoubleLE(l),l+=8;break;case 8:m[p]=1==n[l++];break;case 6:case 10:m[p]=null;break;case 4:g=n[l]|n[l+1]<<8|n[l+2]<<16|n[l+3]<<24,m[p]=e(n,l,!0),l+=g;break;case 3:g=n[l]|n[l+1]<<8|n[l+2]<<16|n[l+3]<<24,m[p]=e(n,l,!1),l+=g;break;case 5:g=n[l++]|n[l++]<<8|n[l++]<<16|n[l++]<<24,n[l++],m[p]=n.slice(l,l+=g);break;case 9:d=n[l++]|n[l++]<<8|n[l++]<<16|n[l++]<<24,v=n[l++]|n[l++]<<8|n[l++]<<16|n[l++]<<24,m[p]=new Date(4294967296*v+(0>d?d+4294967296:d));break;case 18:d=n[l++]|n[l++]<<8|n[l++]<<16|n[l++]<<24,g=4294967296*(v=n[l++]|n[l++]<<8|n[l++]<<16|n[l++]<<24)+(0>d?d+4294967296:d),m[p]=s>g&&g>a?g:new u(d,v);break;case 127:m[p]=new i;break;case 255:m[p]=new o;break;case 17:d=n[l++]|n[l++]<<8|n[l++]<<16|n[l++]<<24,v=n[l++]|n[l++]<<8|n[l++]<<16|n[l++]<<24,m[p]=new r(d,v)}}return m}}).call(this,e("buffer").Buffer)},{"./long":35,"./objectid":38,buffer:4}],30:[function(e,t,n){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=void 0,o=n.SDKOptions={WSHOST:"wss.scorocode.ru",WS_PROTOCOL:"wss",HOST:"api.scorocode.ru",PORT:"443",CREATE_INSTANCE_URL:"/api/v1/instance/create",UPDATE_INSTANCE_URL:"/api/v1/instance/update",REMOVE_INSTANCE_URL:"/api/v1/instance/delete",RUN_INSTANCE_URL:"/api/v1/instance/run",STOP_INSTANCE_URL:"/api/v1/instance/stop",LIST_INSTANCE_URL:"/api/v1/instance",SCRIPTS_INSTANCE_URL:"/api/v1/instance/scripts",RUN_SCRIPT_INSTANCE_URL:"/api/v1/instance/scripts/run",KILL_SCRIPT_INSTANCE_URL:"/api/v1/instance/scripts/delete",GET_AUTH_URL:"/api/v1/verifylogin",FIND_URL:"/api/v1/data/find",COUNT_URL:"/api/v1/data/count",UPDATE_URL:"/api/v1/data/update",UPDATE_BY_ID_URL:"/api/v1/data/updatebyid",REMOVE_URL:"/api/v1/data/remove",INSERT_URL:"/api/v1/data/insert",SEND_PUSH_URL:"/api/v1/sendpush",SEND_SMS_URL:"/api/v1/sendsms",CLOUD_CODE_URL:"/api/v1/scripts",UPLOAD_URL:"/api/v1/upload",REMOVE_FILE_URL:"/api/v1/deletefile",GET_FILE_LINK_URL:"",SIGN_UP_URL:"/api/v1/register",LOGOUT_URL:"/api/v1/logout",LOGIN_URL:"/api/v1/login",DATA_STATS:"/api/v1/stat",BOT_HOST:"bots.scorocode.ru",BOT_URL:"/bots/",GET_APP_URL:"/api/v1/app",UPDATE_APP_KEY:"/api/v1/app/keys/update",GET_COLLECTIONS_URL:"/api/v1/app/collections",GET_COLLECTION_URL:"/api/v1/app/collections/get",CREATE_COLLECTION_URL:"/api/v1/app/collections/create",UPDATE_COLLECTION_URL:"/api/v1/app/collections/update",DELETE_COLLECTION_URL:"/api/v1/app/collections/delete",CLONE_COLLECTION_URL:"/api/v1/app/collections/clone",CREATE_INDEX_URL:"/api/v1/app/collections/index/create",DELETE_INDEX_URL:"/api/v1/app/collections/index/delete",CREATE_FIELD_URL:"/api/v1/app/collections/fields/create",UPDATE_FIELD_URL:"/api/v1/app/collections/fields/update",DELETE_FIELD_URL:"/api/v1/app/collections/fields/delete",UPDATE_TRIGGERS_URL:"/api/v1/app/collections/triggers",GET_FOLDERS_URL:"/api/v1/app/scripts/folders",CREATE_FOLDER_URL:"/api/v1/app/scripts/folders/create",DELETE_FOLDER_URL:"/api/v1/app/scripts/folders/delete",GET_SCRIPT_URL:"/api/v1/app/scripts/get",CREATE_SCRIPT_URL:"/api/v1/app/scripts/create",UPDATE_SCRIPT_URL:"/api/v1/app/scripts/update",DELETE_SCRIPT_URL:"/api/v1/app/scripts/delete",GET_BOTS_URL:"/api/v1/bots",CREATE_BOT_URL:"/api/v1/bots/create",UPDATE_BOT_URL:"/api/v1/bots/update",DELETE_BOT_URL:"/api/v1/bots/delete",TIMEOUT:12e4};n.Client=function(){function n(r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),"string"!=typeof r.ApplicationID)throw new Error("Invalid Application ID");if("string"!=typeof r.JavaScriptKey)throw new Error("Invalid JavaScript Key");if(r.MasterKey&&"string"!=typeof r.MasterKey)throw new Error("Invalid MasterKey");if(this.middleware=[],this.applicationID=r.ApplicationID,this.clientKey=r.JavaScriptKey,this.masterKey=r.MasterKey||"",this.messageKey=r.MessageKey||"",this.scriptKey=r.ScriptKey||"",this.fileKey=r.FileKey||"",this.websocketKey=r.WebSocketKey||"",this.sessionId=r.sessionId||"",this.host="https://scorocode.ru",this.port="443",r.EncryptKey&&"string"!=typeof r.EncryptKey)throw new Error("Invalid EncryptKey");this.EncryptKey="",this.isNode=!1,"object"===("undefined"==typeof e?"undefined":t(e))&&e+""=="[object process]"&&(this.isNode=!0)}return r(n,[{key:"get",value:function(e){return o[e]}},{key:"set",value:function(e,t){o[e]=t}}],[{key:"init",value:function(e){var t=new n(e);return i=t,t}},{key:"getInstance",value:function(){return i}}]),n}()}).call(this,e("_process"))},{_process:3}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SCCloudCode=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./protocol"),s=e("./utils"),a=e("./httpRequest"),u=e("./client"),c=e("./websocket"),l=e("./logger");n.SCCloudCode=function(){function e(t){var n=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"!=typeof t)throw new Error("Invalid script id");this.debugChannel=("0"+1e7*Math.random()).slice(-7),r.logger instanceof l.SCLogger&&(this.logger=r.logger,this._ws=new c.SCWebSocket(this.debugChannel),this._ws.on("open",(function(){})),this._ws.on("error",(function(e){n.logger.error(e)})),this._ws.on("message",(function(e){n.logger.log(e)}))),this.isRunByPath=!!r.isRunByPath,this.id=t}return i(e,[{key:"runSync",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments[1];if("object"!==("undefined"==typeof e?"undefined":r(e)))throw new Error("Invalid type of pool");var n={url:u.SDKOptions.CLOUD_CODE_URL},i=parseInt(1e7*Math.random()),l=o.CloudCodeProtocol.init({script:this.isRunByPath?"":this.id,isRunByPath:this.isRunByPath,path:this.isRunByPath?this.id:"",pool:Object.assign({channelId:i},e),debug:!1},n),f=new Promise((function(e,t){var n=new a.HttpRequest(l),r=new c.SCWebSocket(i),o=setTimeout((function(){r.wsInstanse.close(),clearTimeout(o),t({errMsg:"Gateway Timeout",errCode:504,error:!0})}),12e4);r.on("open",(function(){n.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?t(e):void 0}))})),r.on("error",(function(e){return t(e)})),r.on("message",(function(t){return r.wsInstanse.close(),clearTimeout(o),e(t)}))}));return s.Utils.wrapCallbacks(f,t)}},{key:"run",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments[1],n=arguments[2];if("object"!==("undefined"==typeof e?"undefined":r(e)))throw new Error("Invalid type of pool");"object"===("undefined"==typeof t?"undefined":r(t))&&(n=t);var i={url:u.SDKOptions.CLOUD_CODE_URL},c=o.CloudCodeProtocol.init({isRunByPath:this.isRunByPath,script:this.isRunByPath?"":this.id,path:this.isRunByPath?this.id:"",pool:e,debug:t,debugChannel:this.debugChannel},i),l=new a.HttpRequest(c),f=l.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}));return s.Utils.wrapCallbacks(f,n)}}]),e}()},{"./client":30,"./httpRequest":32,"./logger":34,"./protocol":40,"./utils":48,"./websocket":49}],32:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.HttpRequest=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(e("./observer")),o=e("./client"),s=null;"undefined"==typeof XMLHttpRequest&&(s=e("https")),n.HttpRequest=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.method="",this.port="",this.path="",this.host="",this.data="",this.headers={};var n=t.toJson();for(var r in n)this[r]=n[r]}return r(e,[{key:"node_request",value:function(){var e=this;return new Promise((function(t,n){var r=s.request({method:e.method,port:e.port,path:e.path,host:e.host,headers:e.headers},(function(e){var r="";return 200!==e.statusCode?n({error:!0,errCode:e.statusCode,errMsg:e.responseText||"Invalid statusCode"}):(e.on("data",(function(e){r+=e.toString()})),e.on("error",(function(t){return n({error:!0,errCode:e.statusCode,errMsg:t.message})})),void e.on("end",(function(){return t(r)})))}));r.on("aborted",(function(){return n({error:!0,errCode:504,errMsg:"Request has been aborted by the server"})})),r.on("abort",(function(){return n({error:!0,errCode:418,errMsg:"Request has been aborted by the client"})})),r.on("error",(function(e){return n({error:!0,errCode:422,errMsg:e.message})})),r.setTimeout(e.timeout,(function(){r.abort()})),r.write(e.data),r.end()}))}},{key:"ajax",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=new Promise((function(n,r){var i="https://"+e.host+e.path,o=new XMLHttpRequest;for(var s in o.timeout=e.timeout,o.open(e.method,i,!0),e.headers)o.setRequestHeader(s,e.headers[s]);o.onreadystatechange=function(){return 4==o.readyState?200!=o.status?r(new Error("Invalid statusCode: "+o.status)):void n(o.responseText):void 0},t.onXHRPrepare&&t.onXHRPrepare(o),o.send(e.data)}));return n}},{key:"request",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return"undefined"!=typeof XMLHttpRequest?this.ajax(e):this.node_request()}},{key:"execute",value:function(){for(var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=o.Client.getInstance(),n=function(e){return function(){return e().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):Promise.resolve(JSON.stringify(e))})).catch((function(e){return(0,i.default)().emit("error",e),Promise.reject(e)}))}},r=n(this.request.bind(this)),s=0;s<t.middleware.length;s++)r=t.middleware[s](r);return r(e)}}]),e}()},{"./client":30,"./observer":39,https:void 0}],33:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SCInstance=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./utils"),o=e("./httpRequest"),s=e("./protocol"),a=e("./client");n.SCInstance=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._extend(t)}return r(e,[{key:"_extend",value:function(e){for(var t in e)this[t]=e[t]}},{key:"save",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=this.id?{url:a.SDKOptions.UPDATE_INSTANCE_URL}:{url:a.SDKOptions.CREATE_INSTANCE_URL},r=s.Protocol.init(n);r.setData({id:this.id||null,name:this.name,autorun:this.autorun||[]});var u=new o.HttpRequest(r),c=u.execute().then((function(e){return JSON.parse(e)})).then((function(t){return t.error?Promise.reject(t):(e._extend(t.result),e)}));return i.Utils.wrapCallbacks(c,t)}},{key:"remove",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t={url:a.SDKOptions.REMOVE_INSTANCE_URL},n=s.Protocol.init(t);n.setData({id:this.id});var r=new o.HttpRequest(n),u=r.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e.result}));return i.Utils.wrapCallbacks(u,e)}},{key:"run",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t={url:a.SDKOptions.RUN_INSTANCE_URL},n=s.Protocol.init(t);n.setData({id:this.id});var r=new o.HttpRequest(n),u=r.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e.result}));return i.Utils.wrapCallbacks(u,e)}},{key:"stop",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t={url:a.SDKOptions.STOP_INSTANCE_URL},n=s.Protocol.init(t);n.setData({id:this.id});var r=new o.HttpRequest(n),u=r.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e.result}));return i.Utils.wrapCallbacks(u,e)}},{key:"runScript",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={url:a.SDKOptions.RUN_SCRIPT_INSTANCE_URL},u=s.Protocol.init(r);u.setData({id:this.id,path:e,pool:t});var c=new o.HttpRequest(u),l=c.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e.result}));return i.Utils.wrapCallbacks(l,n)}},{key:"killScript",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n={url:a.SDKOptions.KILL_SCRIPT_INSTANCE_URL},r=s.Protocol.init(n);r.setData({id:this.id,pid:e});var u=new o.HttpRequest(r),c=u.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e.result}));return i.Utils.wrapCallbacks(c,t)}},{key:"getScripts",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t={url:a.SDKOptions.SCRIPTS_INSTANCE_URL},n=s.Protocol.init(t);n.setData({id:this.id});var r=new o.HttpRequest(n),u=r.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e.result}));return i.Utils.wrapCallbacks(u,e)}}]),e}()},{"./client":30,"./httpRequest":32,"./protocol":40,"./utils":48}],34:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.SCLogger=function e(){arguments.length<=0||void 0===arguments[0]||arguments[0],r(this,e),this.log=function(){console.log.apply(this,arguments)},this.error=function(){console.error.apply(this,arguments)}}},{}],35:[function(e,t,n){"use strict";function r(e,t){return this instanceof r?(this._bsontype="Long",this.low_=0|e,void(this.high_=0|t)):new r(e,t)}r.prototype.toInt=function(){return this.low_},r.prototype.toNumber=function(){return this.high_*r.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},r.prototype.toJSON=function(){return this.toString()},r.prototype.toString=function(e){var t=e||10;if(2>t||t>36)throw Error("radix out of range: "+t);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(r.MIN_VALUE)){var n=r.fromNumber(t),i=this.div(n),o=i.multiply(n).subtract(this);return i.toString(t)+o.toInt().toString(t)}return"-"+this.negate().toString(t)}for(var s=r.fromNumber(Math.pow(t,6)),a=(o=this,"");;){var u=o.div(s),c=o.subtract(u.multiply(s)).toInt().toString(t);if((o=u).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},r.prototype.getHighBits=function(){return this.high_},r.prototype.getLowBits=function(){return this.low_},r.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:r.TWO_PWR_32_DBL_+this.low_},r.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(r.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!=this.high_?this.high_:this.low_,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high_?t+33:t+1},r.prototype.isZero=function(){return 0==this.high_&&0==this.low_},r.prototype.isNegative=function(){return this.high_<0},r.prototype.isOdd=function(){return 1==(1&this.low_)},r.prototype.equals=function(e){return this.high_==e.high_&&this.low_==e.low_},r.prototype.notEquals=function(e){return this.high_!=e.high_||this.low_!=e.low_},r.prototype.lessThan=function(e){return this.compare(e)<0},r.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},r.prototype.greaterThan=function(e){return this.compare(e)>0},r.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0},r.prototype.compare=function(e){if(this.equals(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.subtract(e).isNegative()?-1:1},r.prototype.negate=function(){return this.equals(r.MIN_VALUE)?r.MIN_VALUE:this.not().add(r.ONE)},r.prototype.add=function(e){var t=this.high_>>>16,n=65535&this.high_,i=this.low_>>>16,o=65535&this.low_,s=e.high_>>>16,a=65535&e.high_,u=e.low_>>>16,c=0,l=0,f=0,h=0;return f+=(h+=o+(65535&e.low_))>>>16,h&=65535,l+=(f+=i+u)>>>16,f&=65535,c+=(l+=n+a)>>>16,l&=65535,c+=t+s,c&=65535,r.fromBits(f<<16|h,c<<16|l)},r.prototype.subtract=function(e){return this.add(e.negate())},r.prototype.multiply=function(e){if(this.isZero())return r.ZERO;if(e.isZero())return r.ZERO;if(this.equals(r.MIN_VALUE))return e.isOdd()?r.MIN_VALUE:r.ZERO;if(e.equals(r.MIN_VALUE))return this.isOdd()?r.MIN_VALUE:r.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(r.TWO_PWR_24_)&&e.lessThan(r.TWO_PWR_24_))return r.fromNumber(this.toNumber()*e.toNumber());var t=this.high_>>>16,n=65535&this.high_,i=this.low_>>>16,o=65535&this.low_,s=e.high_>>>16,a=65535&e.high_,u=e.low_>>>16,c=65535&e.low_,l=0,f=0,h=0,p=0;return h+=(p+=o*c)>>>16,p&=65535,f+=(h+=i*c)>>>16,h&=65535,f+=(h+=o*u)>>>16,h&=65535,l+=(f+=n*c)>>>16,f&=65535,l+=(f+=i*u)>>>16,f&=65535,l+=(f+=o*a)>>>16,f&=65535,l+=t*c+n*u+i*a+o*s,l&=65535,r.fromBits(h<<16|p,l<<16|f)},r.prototype.div=function(e){if(e.isZero())throw Error("division by zero");if(this.isZero())return r.ZERO;if(this.equals(r.MIN_VALUE)){if(e.equals(r.ONE)||e.equals(r.NEG_ONE))return r.MIN_VALUE;if(e.equals(r.MIN_VALUE))return r.ONE;if((i=this.shiftRight(1).div(e).shiftLeft(1)).equals(r.ZERO))return e.isNegative()?r.ONE:r.NEG_ONE;var t=this.subtract(e.multiply(i));return i.add(t.div(e))}if(e.equals(r.MIN_VALUE))return r.ZERO;if(this.isNegative())return e.isNegative()?this.negate().div(e.negate()):this.negate().div(e).negate();if(e.isNegative())return this.div(e.negate()).negate();var n=r.ZERO;for(t=this;t.greaterThanOrEqual(e);){for(var i=Math.max(1,Math.floor(t.toNumber()/e.toNumber())),o=Math.ceil(Math.log(i)/Math.LN2),s=48>=o?1:Math.pow(2,o-48),a=r.fromNumber(i),u=a.multiply(e);u.isNegative()||u.greaterThan(t);)i-=s,u=(a=r.fromNumber(i)).multiply(e);a.isZero()&&(a=r.ONE),n=n.add(a),t=t.subtract(u)}return n},r.prototype.modulo=function(e){return this.subtract(this.div(e).multiply(e))},r.prototype.not=function(){return r.fromBits(~this.low_,~this.high_)},r.prototype.and=function(e){return r.fromBits(this.low_&e.low_,this.high_&e.high_)},r.prototype.or=function(e){return r.fromBits(this.low_|e.low_,this.high_|e.high_)},r.prototype.xor=function(e){return r.fromBits(this.low_^e.low_,this.high_^e.high_)},r.prototype.shiftLeft=function(e){if(0==(e&=63))return this;var t=this.low_;if(32>e){var n=this.high_;return r.fromBits(t<<e,n<<e|t>>>32-e)}return r.fromBits(0,t<<e-32)},r.prototype.shiftRight=function(e){if(0==(e&=63))return this;var t=this.high_;if(32>e){var n=this.low_;return r.fromBits(n>>>e|t<<32-e,t>>e)}return r.fromBits(t>>e-32,t>=0?0:-1)},r.prototype.shiftRightUnsigned=function(e){if(0==(e&=63))return this;var t=this.high_;if(32>e){var n=this.low_;return r.fromBits(n>>>e|t<<32-e,t>>>e)}return 32==e?r.fromBits(t,0):r.fromBits(t>>>e-32,0)},r.fromInt=function(e){if(e>=-128&&128>e){var t=r.INT_CACHE_[e];if(t)return t}var n=new r(0|e,0>e?-1:0);return e>=-128&&128>e&&(r.INT_CACHE_[e]=n),n},r.fromNumber=function(e){return isNaN(e)||!isFinite(e)?r.ZERO:e<=-r.TWO_PWR_63_DBL_?r.MIN_VALUE:e+1>=r.TWO_PWR_63_DBL_?r.MAX_VALUE:0>e?r.fromNumber(-e).negate():new r(e%r.TWO_PWR_32_DBL_|0,e/r.TWO_PWR_32_DBL_|0)},r.fromBits=function(e,t){return new r(e,t)},r.fromString=function(e,t){if(0==e.length)throw Error("number format error: empty string");var n=t||10;if(2>n||n>36)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return r.fromString(e.substring(1),n).negate();if(e.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+e);for(var i=r.fromNumber(Math.pow(n,8)),o=r.ZERO,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+a),n);if(8>a){var c=r.fromNumber(Math.pow(n,a));o=o.multiply(c).add(r.fromNumber(u))}else o=(o=o.multiply(i)).add(r.fromNumber(u))}return o},r.INT_CACHE_={},r.TWO_PWR_16_DBL_=65536,r.TWO_PWR_24_DBL_=1<<24,r.TWO_PWR_32_DBL_=r.TWO_PWR_16_DBL_*r.TWO_PWR_16_DBL_,r.TWO_PWR_31_DBL_=r.TWO_PWR_32_DBL_/2,r.TWO_PWR_48_DBL_=r.TWO_PWR_32_DBL_*r.TWO_PWR_16_DBL_,r.TWO_PWR_64_DBL_=r.TWO_PWR_32_DBL_*r.TWO_PWR_32_DBL_,r.TWO_PWR_63_DBL_=r.TWO_PWR_64_DBL_/2,r.ZERO=r.fromInt(0),r.ONE=r.fromInt(1),r.NEG_ONE=r.fromInt(-1),r.MAX_VALUE=r.fromBits(-1,2147483647),r.MIN_VALUE=r.fromBits(0,-2147483648),r.TWO_PWR_24_=r.fromInt(1<<24),t.exports=r,t.exports.Long=r},{}],36:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SCMessenger=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./query"),s=e("./protocol"),a=e("./utils"),u=e("./httpRequest"),c=e("./client"),l=e("./websocket"),f=e("./logger");n.SCMessenger=function(){function e(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),n.logger instanceof f.SCLogger&&(this.logger=n.logger,this._ws=new l.SCWebSocket("messenger_debugger"),this._ws.on("open",(function(){t.logger.log("Debugger is active")})),this._ws.on("error",(function(e){t.logger.error(e)})),this._ws.on("message",(function(e){t.logger.log(e)})))}return i(e,[{key:"sendPush",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if("object"!==("undefined"==typeof e?"undefined":r(e)))throw new Error("Invalid options type");if(!(e.where instanceof o.SCQuery))throw new Error("Where must be a type of Query");if("object"!==r(e.data))throw new Error("Invalid data type");"object"===("undefined"==typeof t?"undefined":r(t))&&(n=t);var i={url:c.SDKOptions.SEND_PUSH_URL},l={msg:e.data,debug:t};a.Utils.extend(l,e.where.toJson());var f=s.MessengerProtocol.init(l,i),h=new u.HttpRequest(f),p=h.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}));return a.Utils.wrapCallbacks(p,n)}},{key:"sendSms",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if("object"!==("undefined"==typeof e?"undefined":r(e)))throw new Error("Invalid options type");if(!(e.where instanceof o.SCQuery))throw new Error("Where must be a type of Query");if("object"!==r(e.data))throw new Error("Invalid data type");if("string"!=typeof e.data.text)throw new Error("Missing subject or text message");"object"===("undefined"==typeof t?"undefined":r(t))&&(n=t);var i={url:c.SDKOptions.SEND_SMS_URL},l={msg:e.data,debug:t};a.Utils.extend(l,e.where.toJson());var f=s.MessengerProtocol.init(l,i),h=new u.HttpRequest(f),p=h.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}));return a.Utils.wrapCallbacks(p,n)}}]),e}()},{"./client":30,"./httpRequest":32,"./logger":34,"./protocol":40,"./query":41,"./utils":48,"./websocket":49}],37:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SCObject=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./query"),o=e("./utils"),s=e("./updateOps"),a=e("./stores/data"),u=e("./client");n.SCObject=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"!=typeof t)throw new Error("Invalid collection name");for(var r in this.collection=t,this.attrs=Object.assign({},n),this.update={},s.operators)this[r]=s.operators[r]}return r(e,[{key:"setAttrs",value:function(e){var t=Object.assign({},e);for(var n in t)this.set(n,t[n])}},{key:"getAttrs",value:function(){return Object.assign({},this.attrs)}},{key:"getById",value:function(e,t){var n=this,r=new i.SCQuery(this.collection);if(!e)throw new Error("Id is empty");return r.equalTo("_id",e).find(t).then((function(e){if(!e.result.length)throw new Error("Document not found");return n.attrs={},o.Utils.extend(n.attrs,e.result[0]),e.result[0]}))}},{key:"get",value:function(e){return this.attrs[e]}},{key:"getFileLink",value:function(e){if(!this.attrs._id)throw new Error("You must first create a document and upload file");if(!this.attrs.hasOwnProperty(e))throw new Error("Unknown field");if(!this.attrs[e])throw new Error("Field is empty");return"https://api.scorocode.ru/api/v1/getfile/"+u.Client.getInstance().applicationID+"/"+this.collection+"/"+e+"/"+this.attrs._id+"/"+this.attrs[e]}},{key:"removeFile",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!this.attrs._id)throw new Error("You must first create a document and upload file");if(!this.attrs.hasOwnProperty(e))throw new Error("Unknown field");if(!this.attrs[e])throw new Error("Field is empty");var r=this.toJson(),i={coll:r.coll,docId:this.attrs._id,field:e,file:this.attrs[e]};return a.DataStore.getInstance().removeFile(i,n).then((function(n){return n.error||(t.attrs[e]=""),n}))}},{key:"uploadFile",value:function(e,t,n){var r=this,i=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];if(!this.attrs._id)throw new Error("You must first create a document");var o=n.split(","),s="";s=2==o.length?o[1]:o[0];var u=this.toJson(),c={coll:u.coll,docId:this.attrs._id,field:e,file:t,content:s};return a.DataStore.getInstance().uploadFile(c,i).then((function(t){return t.error||(r.attrs[e]=t.result),t}))}},{key:"toJson",value:function(){return{coll:this.collection,query:this.attrs._id?{_id:this.attrs._id}:{},doc:this.attrs._id?this.update:this.attrs}}},{key:"save",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.attrs._id?a.DataStore.getInstance().updateById(this.toJson(),t).then((function(t){return t.error||(e.attrs=t.result),e.update={},t.result})):a.DataStore.getInstance().insert(this.toJson(),t).then((function(t){return t.error||(e.attrs=t.result),t.result}))}},{key:"remove",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(!this.attrs._id)throw new Error("Document does't exist");var t=new i.SCQuery(this.collection);return t.equalTo("_id",this.attrs._id).remove(e).then((function(e){return e}))}}],[{key:"extend",value:function(t,n){var r=new e(t);for(var i in n)r.attrs[i]=n[i];return r}}]),e}()},{"./client":30,"./query":41,"./stores/data":43,"./updateOps":46,"./utils":48}],38:[function(e,t,n){(function(e,n){"use strict";var r=parseInt(16777215*Math.random(),10),i=new RegExp("^[0-9a-fA-F]{24}$"),o=!1;try{n&&n.from&&(o=!0)}catch(h){}for(var s=function e(t){if(t instanceof e)return t;if(!(this instanceof e))return new e(t);if(this._bsontype="ObjectID",null==t||"number"==typeof t)return this.id=this.generate(t),void(e.cacheHexString&&(this.__id=this.toString("hex")));var r=e.isValid(t);if(!r&&null!=t)throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(r&&"string"==typeof t&&24==t.length&&o)return new e(new n(t,"hex"));if(r&&"string"==typeof t&&24==t.length)return e.createFromHexString(t);if(null==t||12!==t.length){if(null!=t&&t.toHexString)return t;throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}this.id=t,e.cacheHexString&&(this.__id=this.toString("hex"))},a=[],u=0;256>u;u++)a[u]=(15>=u?"0":"")+u.toString(16);s.prototype.toHexString=function(){if(s.cacheHexString&&this.__id)return this.__id;var e="";if(!this.id||!this.id.length)throw new Error("invalid ObjectId, ObjectId.id must be either a string or a Buffer, but is ["+JSON.stringify(this.id)+"]");if(this.id instanceof l)return e=f(this.id),s.cacheHexString&&(this.__id=e),e;for(var t=0;t<this.id.length;t++)e+=a[this.id.charCodeAt(t)];return s.cacheHexString&&(this.__id=e),e},s.prototype.get_inc=function(){return s.index=(s.index+1)%16777215},s.prototype.getInc=function(){return this.get_inc()},s.prototype.generate=function(t){"number"!=typeof t&&(t=~~(Date.now()/1e3));var i=("undefined"==typeof e?Math.floor(1e5*Math.random()):e.pid)%65535,o=this.get_inc(),s=new n(12);return s[3]=255&t,s[2]=t>>8&255,s[1]=t>>16&255,s[0]=t>>24&255,s[6]=255&r,s[5]=r>>8&255,s[4]=r>>16&255,s[8]=255&i,s[7]=i>>8&255,s[11]=255&o,s[10]=o>>8&255,s[9]=o>>16&255,s},s.prototype.toString=function(e){return this.id&&this.id.copy?this.id.toString("string"==typeof e?e:"hex"):this.toHexString()},s.prototype.inspect=s.prototype.toString,s.prototype.toJSON=function(){return this.toHexString()},s.prototype.equals=function(e){return e instanceof s?this.toString()==e.toString():"string"==typeof e&&s.isValid(e)&&12==e.length&&this.id instanceof l?e===this.id.toString("binary"):"string"==typeof e&&s.isValid(e)&&24==e.length?e.toLowerCase()===this.toHexString():"string"==typeof e&&s.isValid(e)&&12==e.length?e===this.id:!(null==e||!(e instanceof s||e.toHexString))&&e.toHexString()===this.toHexString()},s.prototype.getTimestamp=function(){var e=new Date,t=this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24;return e.setTime(1e3*Math.floor(t)),e},s.index=~~(16777215*Math.random()),s.createPk=function(){return new s},s.createFromTime=function(e){var t=new n([0,0,0,0,0,0,0,0,0,0,0,0]);return t[3]=255&e,t[2]=e>>8&255,t[1]=e>>16&255,t[0]=e>>24&255,new s(t)};var c=("0123456789abcdef".split(""),[]);for(u=0;10>u;)c[48+u]=u++;for(;16>u;)c[55+u]=c[87+u]=u++;var l=n,f=function(e){return e.toString("hex")};s.createFromHexString=function(e){if("undefined"==typeof e||null!=e&&24!=e.length)throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(o)return new s(new n(e,"hex"));for(var t=new l(12),r=0,i=0;24>i;)t[r++]=c[e.charCodeAt(i++)]<<4|c[e.charCodeAt(i++)];return new s(t)},s.isValid=function(e){return null!=e&&("number"==typeof e||("string"==typeof e?12==e.length||24==e.length&&i.test(e):e instanceof s||e instanceof l||!!e.toHexString&&(12==e.id.length||24==e.id.length&&i.test(e.id))))},Object.defineProperty(s.prototype,"generationTime",{enumerable:!0,get:function(){return this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24},set:function(e){this.id[3]=255&e,this.id[2]=e>>8&255,this.id[1]=e>>16&255,this.id[0]=e>>24&255}}),t.exports=s,t.exports.ObjectID=s,t.exports.ObjectId=s}).call(this,e("_process"),e("buffer").Buffer)},{_process:3,buffer:4}],39:[function(e,t,n){"use strict";function r(){return i||(this&&this.constructor===r?void(i=this):new r)}var i;Object.defineProperty(n,"__esModule",{value:!0}),r.prototype._listeners={},r.prototype.emit=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.shift();if(!this._listeners[n])return!1;for(var r=this._listeners[n].length,i=0;r>i;i++)this._listeners[n][i].apply(null,e)},r.prototype.on=function(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)};var o=r;n.default=o},{}],40:[function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.CloudFileProtocol=n.BotProtocol=n.CloudCodeProtocol=n.MessengerProtocol=n.UserProtocol=n.DataProtocol=n.Protocol=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e("./client"),u=n.Protocol=function(){function e(t,n){o(this,e),this.method="POST",this.host=t.get("HOST"),this.port=t.get("PORT"),this.path=n.url,this.data={app:t.applicationID,cli:t.clientKey,acc:t.masterKey},this.headers={"Content-Type":"application/json"},t.sessionId&&(this.headers.Authorization="Bearer "+t.sessionId),this.timeout=n.timeout||t.get("TIMEOUT")}return s(e,[{key:"setAccessKey",value:function(e,t){return this.data[e]=t,this}},{key:"setData",value:function(e){for(var t in e)Object.defineProperty(this.data,t,{value:e[t],enumerable:!0,writable:!0,configurable:!0});return this}},{key:"setDoc",value:function(e){return e&&(this.data.doc=e),this}},{key:"setIndex",value:function(e){this.data.index=e}},{key:"setField",value:function(e){this.data.collField=e}},{key:"setPath",value:function(e){this.data.path=e}},{key:"setTriggers",value:function(e){this.data.triggers=e}},{key:"setColl",value:function(e){return this.data.coll=e,this}},{key:"setCollection",value:function(e){return this.data.collection=e,this}},{key:"toJson",value:function(){var e={};for(var t in this)e[t]="data"!==t?this[t]:JSON.stringify(this[t]);return e}}],[{key:"init",value:function(t){return new e(a.Client.getInstance(),t)}}]),e}();n.DataProtocol=function(e){function t(e,n){return o(this,t),r(this,Object.getPrototypeOf(t).call(this,e,n))}return i(t,e),s(t,null,[{key:"init",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=arguments[2],i=a.Client.getInstance(),o=new t(i,r);return o.setData(e),o.setDoc(n),o}}]),t}(u),n.UserProtocol=function(e){function t(e,n){return o(this,t),r(this,Object.getPrototypeOf(t).call(this,e,n))}return i(t,e),s(t,null,[{key:"init",value:function(e,n,r){var i=new t(a.Client.getInstance(),r);return i.setData(e),i.setDoc(n),i}}]),t}(u),n.MessengerProtocol=function(e){function t(e,n){return o(this,t),r(this,Object.getPrototypeOf(t).call(this,e,n))}return i(t,e),s(t,null,[{key:"init",value:function(e,n){var r=a.Client.getInstance(),i=new t(r,n);return i.setData(e),i.setAccessKey("acc",r.masterKey||r.messageKey),i}}]),t}(u),n.CloudCodeProtocol=function(e){function t(e,n){return o(this,t),r(this,Object.getPrototypeOf(t).call(this,e,n))}return i(t,e),s(t,null,[{key:"init",value:function(e,n){var r=a.Client.getInstance(),i=new t(r,n);return i.setData(e),i.setAccessKey("acc",r.masterKey||r.scriptKey),i}}]),t}(u),n.BotProtocol=function(){function e(t,n,r){o(this,e),this.method="POST",this.host=n.get("BOT_HOST"),this.port=n.get("PORT"),this.path=n.get("BOT_URL")+t+"/response",this.data={},this.headers={"Content-Type":"application/json"},this.timeout=r.timeout||n.get("TIMEOUT")}return s(e,[{key:"setData",value:function(e){for(var t in e)Object.defineProperty(this.data,t,{value:e[t],enumerable:!0,writable:!0,configurable:!0})}},{key:"toJson",value:function(){var e={};for(var t in this)e[t]="data"!==t?this[t]:JSON.stringify(this[t]);return e}}],[{key:"init",value:function(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=a.Client.getInstance(),i=new e(t,r,n);return i}}]),e}(),n.CloudFileProtocol=function(e){function t(){o(this,t);var e=r(this,Object.getPrototypeOf(t).call(this));return e.docId="",e.field="",e}return i(t,e),t}(u)},{"./client":30}],41:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SCQuery=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./utils"),s=e("./stores/data"),a=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"!=typeof t)throw new Error("Collection name must be a type of string");this._collection=t,this._fields=[],this._filter={},this._sort={},this._limit=100,this._skip=0}return i(e,[{key:"_addFilter",value:function(e,t,n){return o.Utils.isObject(this._filter[e])||(this._filter[e]={}),"object"===("undefined"==typeof t?"undefined":r(t))?(this._filter[e]=t,this):(this._filter[e][t]=n,this)}},{key:"find",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return s.DataStore.getInstance().find(this.toJson(),e)}},{key:"findAll",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=[];return o.Utils.promiseWhile((function(t){return!t||!!t.result.length&&(n=n.concat(t.result),e.skip(e._skip+e._limit),!0)}),(function(){return s.DataStore.getInstance().find(e.toJson(),t)})).then((function(e){return n}))}},{key:"count",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return s.DataStore.getInstance().count(this.toJson(),e)}},{key:"update",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return s.DataStore.getInstance().update(this.toJson(),e.toJson(),t)}},{key:"remove",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return s.DataStore.getInstance().remove(this.toJson(),e)}},{key:"reset",value:function(){return this._filter={},this.fields=[],this}},{key:"equalTo",value:function(e,t){return this._filter[e]=t,this}},{key:"notEqualTo",value:function(e,t){return this._addFilter(e,"$ne",t)}},{key:"containedIn",value:function(e,t){if(!o.Utils.isArray(t))throw new Error("Value must be of type: Array");return this._addFilter(e,"$in",t)}},{key:"containsAll",value:function(e,t){if(!o.Utils.isArray(t))throw new Error("Value must be of type: Array");return this._addFilter(e,"$all",t)}},{key:"notContainedIn",value:function(e,t){if(!o.Utils.isArray(t))throw new Error("Value must be of type: Array");return this._addFilter(e,"$nin",t)}},{key:"greaterThan",value:function(e,t){return this._addFilter(e,"$gt",t)}},{key:"greaterThanOrEqualTo",value:function(e,t){return this._addFilter(e,"$gte",t)}},{key:"lessThan",value:function(e,t){return this._addFilter(e,"$lt",t)}},{key:"lessThanOrEqualTo",value:function(e,t){return this._addFilter(e,"$lte",t)}},{key:"exists",value:function(e){return this._addFilter(e,"$exists",!0)}},{key:"doesNotExist",value:function(e){return this._addFilter(e,"$exists",!1)}},{key:"contains",value:function(e,t,n){return n?this._addFilter(e,{$regex:t,$options:n}):this._addFilter(e,"$regex",t)}},{key:"startsWith",value:function(e,t,n){if("string"!=typeof t)throw new Error("Value must be a string");return n?this._addFilter(e,{$regex:"^"+t,$options:n}):this._addFilter(e,"$regex","^"+t)}},{key:"endsWith",value:function(e,t,n){if("string"!=typeof t)throw new Error("Value must be a string");return n?this._addFilter(e,{$regex:t+"$",$options:n}):this._addFilter(e,"$regex",t+"$")}},{key:"limit",value:function(e){if(!o.Utils.isNumber(e)||0>e)throw new Error("Limit must be a positive number");return this._limit=e,this}},{key:"skip",value:function(e){if(!o.Utils.isNumber(e)||0>e)throw new Error("Skip must be a positive number");return this._skip=e,this}},{key:"page",value:function(e){if(!o.Utils.isNumber(e)||0>e)throw new Error("Page must be a positive number");return this._skip=(e-1)*this._limit,this}},{key:"ascending",value:function(e){return this._sort[e]=1,this}},{key:"descending",value:function(e){return this._sort[e]=-1,this}},{key:"or",value:function(t){if(!(t instanceof e))throw new Error("Invalid type of Query");return this._filter.$or||(this._filter.$or=[]),this._filter.$or.push(t.toJson().query),this}},{key:"and",value:function(t){if(!(t instanceof e))throw new Error("Invalid type of Query");return this._filter.$and||(this._filter.$and=[]),this._filter.$and.push(t.toJson().query),this}},{key:"select",value:function(){this._fields=[];for(var e=arguments.length,t=0;e>t;t++)this._fields.push(arguments[t]);return this}},{key:"raw",value:function(e){if(!o.Utils.isObject(e))throw new Error("Filter must be a object");return this._filter=e,this}},{key:"toJson",value:function(){return{coll:this._collection,limit:this._limit,skip:this._skip,query:this._filter,sort:this._sort,fields:this._fields}}}]),e}();n.SCQuery=a},{"./stores/data":43,"./utils":48}],42:[function(e,t,n){"use strict";var r=e("./query"),i=e("./user"),o=e("./object"),s=e("./client"),a=e("./updateOps"),u=e("./messenger"),c=e("./cloudCode"),l=e("./websocket"),f=e("./system"),h=e("./logger"),p=e("./bot"),d=e("./instance"),v=function(e){return e&&e.__esModule?e:{default:e}}(e("./observer")),y={Init:function(e){return s.Client.init(e)},getSessionId:function(){return s.Client.getInstance().sessionId},setSessionId:function(e){s.Client.getInstance().sessionId=e},on:function(e,t){(0,v.default)().on(e,t)},use:function(e){s.Client.getInstance().middleware.push(e)}};y.Query=r.SCQuery,y.Object=o.SCObject,y.User=i.SCUser,y.UpdateOps=a.SCUpdateOps,y.Messenger=u.SCMessenger,y.CloudCode=c.SCCloudCode,y.WebSocket=l.SCWebSocket,y.System=f.SCSystem,y.Logger=h.SCLogger,y.Bot=p.SCBot,y.Instance=d.SCInstance,y.Field=f.SCField,t.exports=y},{"./bot":28,"./client":30,"./cloudCode":31,"./instance":33,"./logger":34,"./messenger":36,"./object":37,"./observer":39,"./query":41,"./system":45,"./updateOps":46,"./user":47,"./websocket":49}],43:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DataStore=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./networkStore");n.DataStore=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"getInstance",value:function(e){return new i.Network}}]),e}()},{"./networkStore":44}],44:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Network=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../protocol"),o=e("../httpRequest"),s=e("../utils"),a=e("../bson"),u=e("../client");n.Network=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"find",value:function(e,n){var r={url:u.SDKOptions.FIND_URL},c=i.DataProtocol.init(e,null,r),l=new o.HttpRequest(c).execute().then((function(e){return JSON.parse(e)})).then((function(e){if(e.error)return Promise.reject(e);var n=new t(e.result,"base64"),r=(0,a.deserializeFast)(n,0,!0);return{error:!1,limit:e.limit,skip:e.skip,result:r.slice()}}));return s.Utils.wrapCallbacks(l,n)}},{key:"count",value:function(e,t){var n={url:u.SDKOptions.COUNT_URL},r=i.DataProtocol.init(e,null,n),a=new o.HttpRequest(r).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}));return s.Utils.wrapCallbacks(a,t)}},{key:"update",value:function(e,t,n){var r={url:u.SDKOptions.UPDATE_URL},a=i.DataProtocol.init(e,t,r),c=new o.HttpRequest(a).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}));return s.Utils.wrapCallbacks(c,n)}},{key:"updateById",value:function(e,t){var n={url:u.SDKOptions.UPDATE_BY_ID_URL},r=i.DataProtocol.init(e,null,n),a=new o.HttpRequest(r).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}));return s.Utils.wrapCallbacks(a,t)}},{key:"remove",value:function(e,t){var n={url:u.SDKOptions.REMOVE_URL},r=i.DataProtocol.init(e,null,n),a=new o.HttpRequest(r).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e.result}));return s.Utils.wrapCallbacks(a,t)}},{key:"insert",value:function(e,t){var n={url:u.SDKOptions.INSERT_URL},r=i.DataProtocol.init(e,null,n),a=new o.HttpRequest(r).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}));return s.Utils.wrapCallbacks(a,t)}},{key:"uploadFile",value:function(e,t){var n={url:u.SDKOptions.UPLOAD_URL},r=u.Client.getInstance(),a=i.DataProtocol.init(e,null,n);a.setAccessKey("acc",r.masterKey||r.fileKey);var c=new o.HttpRequest(a).execute(t).then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}));return s.Utils.wrapCallbacks(c,t)}},{key:"removeFile",value:function(e,t){var n={url:u.SDKOptions.REMOVE_FILE_URL},r=u.Client.getInstance(),a=i.DataProtocol.init(e,null,n);a.setAccessKey("acc",r.masterKey||r.fileKey);var c=new o.HttpRequest(a).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}));return s.Utils.wrapCallbacks(c,t)}}]),e}()}).call(this,e("buffer").Buffer)},{"../bson":29,"../client":30,"../httpRequest":32,"../protocol":40,"../utils":48,buffer:4}],45:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.SCSystem=n.SCField=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./protocol"),s=e("./utils"),a=e("./httpRequest"),u=e("./client"),c=e("./instance"),l=function(){function e(t){r(this,e),this._extend(t)}return i(e,[{key:"_extend",value:function(e){for(var t in e)this[t]=e[t]}},{key:"save",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(this._id){var n={url:u.SDKOptions.UPDATE_BOT_URL},r=o.Protocol.init(n);r.setData({bot:this});var i=new a.HttpRequest(r),c=i.execute().then((function(e){return JSON.parse(e)})).then((function(t){return t.error?Promise.reject(t):e}));return c}var l={url:u.SDKOptions.CREATE_BOT_URL},f=o.Protocol.init(l);f.setData({bot:this});var h=new a.HttpRequest(f),p=h.execute().then((function(e){return JSON.parse(e)})).then((function(t){return t.error?Promise.reject(t):(e._extend(t.bot),e)}));return s.Utils.wrapCallbacks(p,t)}},{key:"remove",value:function(){var e={url:u.SDKOptions.DELETE_BOT_URL},t=o.Protocol.init(e);return t.setData({bot:{_id:this._id}}),new a.HttpRequest(t).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}))}}]),e}(),f=function(){function e(t,n){for(var i in r(this,e),n)this[i]=n[i];Object.defineProperty(this,"collName",{value:t,enumerable:!1,writable:!1,configurable:!1})}return i(e,[{key:"update",value:function(){var e=this,t={url:u.SDKOptions.UPDATE_TRIGGERS_URL},n=o.Protocol.init(t);return n.setColl(this.collName),n.setTriggers(this),new a.HttpRequest(n).execute().then((function(e){return JSON.parse(e)})).then((function(t){if(t.error)return Promise.reject(t);for(var n in t.triggers)e[n]=t.triggers[n];return e}))}}]),e}(),h=n.SCField=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,e),Object.defineProperty(this,"collName",{value:t,enumerable:!1,writable:!1,configurable:!1}),this._extend(n)}return i(e,[{key:"_extend",value:function(e){for(var t in e)this[t]=e[t];return this}},{key:"save",value:function(){var e,t=this;e=this.id?{url:u.SDKOptions.UPDATE_FIELD_URL}:{url:u.SDKOptions.CREATE_FIELD_URL};var n=o.Protocol.init(e);return n.setColl(this.collName),n.setField(this),new a.HttpRequest(n).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):(t._extend(e.field),t)}))}},{key:"remove",value:function(){var e={url:u.SDKOptions.DELETE_FIELD_URL},t=o.Protocol.init(e);return t.setColl(this.collName),t.setField(this),new a.HttpRequest(t).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}))}}]),e}(),p=function(){function e(t,n,i){r(this,e),this.name=n,this.fields=i,Object.defineProperty(this,"collName",{value:t,enumerable:!1,writable:!1,configurable:!1})}return i(e,[{key:"save",value:function(){var e=this,t={url:u.SDKOptions.CREATE_INDEX_URL},n=o.Protocol.init(t);return n.setColl(this.collName),n.setIndex(this),new a.HttpRequest(n).execute().then((function(e){return JSON.parse(e)})).then((function(t){return t.error?Promise.reject(t):e}))}},{key:"remove",value:function(){var e={url:u.SDKOptions.DELETE_INDEX_URL},t=o.Protocol.init(e);return t.setColl(this.collName),t.setIndex({name:this.name}),new a.HttpRequest(t).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}))}}]),e}(),d=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,e),this.name=t,this.id="",this.useDocsACL=!1,this.ACL={create:[],read:[],remove:[],update:[]},this.triggers={afterInsert:{code:"",isActive:!1},afterRemove:{code:"",isActive:!1},afterUpdate:{code:"",isActive:!1},beforeInsert:{code:"",isActive:!1},beforeRemove:{code:"",isActive:!1},beforeUpdate:{code:"",isActive:!1}},this.fields=[],this.indexes=[],this._extend(n)}return i(e,[{key:"_extend",value:function(e){var t=this;for(var n in e)"fields"!==n?"indexes"!==n?"triggers"!==n?this[n]=e[n]:this.triggers=new f(this.name,e[n]):this.indexes=e[n].map((function(e){return new p(t.name,e.name,e.fields)})):this.fields=e[n].map((function(e){return new h(t.name,e)}))}},{key:"createIndex",value:function(e,t){return new p(this.name,e,t).save()}},{key:"get",value:function(){var e=this,t={url:u.SDKOptions.GET_COLLECTION_URL},n=o.Protocol.init(t);return n.setColl(this.name),new a.HttpRequest(n).execute().then((function(e){return JSON.parse(e)})).then((function(t){return t.error?Promise.reject(t):(e._extend(t.collection),e)}))}},{key:"save",value:function(){var e=this;if(this.id){var t={url:u.SDKOptions.UPDATE_COLLECTION_URL},n=o.Protocol.init(t);return n.setCollection(this),new a.HttpRequest(n).execute().then((function(e){return JSON.parse(e)})).then((function(t){return t.error?Promise.reject(t):(e._extend(t.collection),e)}))}var r={url:u.SDKOptions.CREATE_COLLECTION_URL},i=o.Protocol.init(r);return i.setData({collection:{name:this.name,ACL:this.ACL,useDocsACL:this.useDocsACL,notify:this.notify}}),new a.HttpRequest(i).execute().then((function(e){return JSON.parse(e)})).then((function(t){return t.error?Promise.reject(t):(e._extend(t.collection),e)}))}},{key:"remove",value:function(){var e={url:u.SDKOptions.DELETE_COLLECTION_URL},t=o.Protocol.init(e);return t.setCollection({id:this.id}),new a.HttpRequest(t).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}))}},{key:"clone",value:function(t){var n={url:u.SDKOptions.CLONE_COLLECTION_URL},r=o.Protocol.init(n);return r.setCollection({id:this.id,name:t}),new a.HttpRequest(r).execute().then((function(e){return JSON.parse(e)})).then((function(n){return n.error?Promise.reject(n):new e(t,n.collection)}))}}]),e}(),v=function(){function e(t){r(this,e),this._extend(t)}return i(e,[{key:"_extend",value:function(e){for(var t in e)this[t]=e[t]}},{key:"create",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n={url:u.SDKOptions.CREATE_FOLDER_URL},r=o.Protocol.init(n);r.setPath(this.path);var i=new a.HttpRequest(r),c=i.execute().then((function(e){return JSON.parse(e)})).then((function(t){return t.error?Promise.reject(t):(e._extend(t.folder),e)}));return s.Utils.wrapCallbacks(c,t)}},{key:"remove",value:function(){var e={url:u.SDKOptions.DELETE_FOLDER_URL},t=o.Protocol.init(e);return t.setPath(this.path),new a.HttpRequest(t).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}))}}]),e}(),y=function(){function e(t){r(this,e),this._extend(t)}return i(e,[{key:"remove",value:function(){var e={url:u.SDKOptions.DELETE_SCRIPT_URL},t=o.Protocol.init(e);return t.setColl(this.collName),t.setData({script:this._id}),new a.HttpRequest(t).execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e}))}},{key:"_extend",value:function(e){for(var t in e)this[t]=e[t]}},{key:"save",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(this._id){var n={url:u.SDKOptions.UPDATE_SCRIPT_URL},r=o.Protocol.init(n);r.setData({script:this._id,cloudCode:this});var i=new a.HttpRequest(r),c=i.execute().then((function(e){return JSON.parse(e)})).then((function(t){return t.error?Promise.reject(t):e}));return s.Utils.wrapCallbacks(c,t)}var l={url:u.SDKOptions.CREATE_SCRIPT_URL},f=o.Protocol.init(l);f.setData({cloudCode:this});var h=new a.HttpRequest(f),p=h.execute().then((function(e){return JSON.parse(e)})).then((function(t){return t.error?Promise.reject(t):(e._extend(t.script),e)}));return s.Utils.wrapCallbacks(p,t)}}]),e}(),m=function(){function e(t){for(var n in r(this,e),this.Collection=d,this.Bot=l,this.Folder=v,this.Script=y,t)this[n]=t[n]}return i(e,[{key:"getCollections",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t={url:u.SDKOptions.GET_COLLECTIONS_URL},n=o.Protocol.init(t),r=new a.HttpRequest(n),i=r.execute().then((function(e){return JSON.parse(e)})).then((function(e){if(e.error)return Promise.reject(e);var t=[];for(var n in e.collections)t.push(new d(n,e.collections[n]));return t}));return s.Utils.wrapCallbacks(i,e)}},{key:"getFolderContent",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n={url:u.SDKOptions.GET_FOLDERS_URL},r=o.Protocol.init(n);r.setPath(e);var i=new a.HttpRequest(r),c=i.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e.items.map((function(e){return e.isScript?new y(e):new v(e)}))}));return s.Utils.wrapCallbacks(c,t)}},{key:"getScript",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n={url:u.SDKOptions.GET_SCRIPT_URL},r=o.Protocol.init(n);r.setData({script:e});var i=new a.HttpRequest(r),c=i.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):new y(e.script)}));return s.Utils.wrapCallbacks(c,t)}},{key:"getBots",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={url:u.SDKOptions.GET_BOTS_URL},i=o.Protocol.init(r);i.setData({skip:e||0,limit:t||50});var c=new a.HttpRequest(i),f=c.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e.items.map((function(e){return new l(e)}))}));return s.Utils.wrapCallbacks(f,n)}},{key:"updateKey",value:function(e,t){var n=this,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],i={url:u.SDKOptions.UPDATE_APP_KEY},c=o.Protocol.init(i);c.setData({type:e,key:t});var l=new a.HttpRequest(c),f=l.execute().then((function(e){return JSON.parse(e)})).then((function(r){return r.error?Promise.reject(r):("appId"===e?n[e]=r.result:n[e][t]=r.result,r)}));return s.Utils.wrapCallbacks(f,r)}},{key:"getInstances",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t={url:u.SDKOptions.LIST_INSTANCE_URL},n=o.Protocol.init(t),r=new a.HttpRequest(n),i=r.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e.result.map((function(e){return new c.SCInstance(e)}))}));return s.Utils.wrapCallbacks(i,e)}}]),e}();n.SCSystem=function(){function e(){r(this,e)}return i(e,[{key:"getDataStats",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t={url:u.SDKOptions.DATA_STATS},n=o.Protocol.init(t),r=new a.HttpRequest(n),i=r.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):e.result}));return s.Utils.wrapCallbacks(i,e)}},{key:"getApp",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t={url:u.SDKOptions.GET_APP_URL},n=o.Protocol.init(t),r=new a.HttpRequest(n),i=r.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):new m(e.app)}));return s.Utils.wrapCallbacks(i,e)}}]),e}()},{"./client":30,"./httpRequest":32,"./instance":33,"./protocol":40,"./utils":48}],46:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SCUpdateOps=n.operators=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./utils"),o={set:function(e,t){if(this instanceof s||this.attrs._id){if("createdAt"===e||"updatedAt"===e||"_id"===e)return this;this.update.$set||(this.update.$set={}),this.update.$set[e]=t,this.attrs&&(this.attrs[e]=t)}else this.attrs[e]=t;return this},push:function(e,t){if(!(this instanceof s)){if(!this.attrs._id)throw new Error("For a new document use the method Set");if(!i.Utils.isArray(this.attrs[e]))throw new Error("Field must by a type of array")}return this.update.$push||(this.update.$push={}),this.update.$push[e]=t,this},pull:function(e,t){if(!(this instanceof s||this.attrs._id))throw new Error("For a new document use the method Set");return this.update.$pull||(this.update.$pull={}),this.update.$pull[e]=t,this},pullAll:function(e,t){if(!(this instanceof s||this.attrs._id))throw new Error("For a new document use the method Set");if(!i.Utils.isArray(t))throw new Error("Value must by a type of array");return this.update.$pullAll||(this.update.$pullAll={}),this.update.$pullAll[e]=t,this},addToSet:function(e,t){if(!(this instanceof s||this.attrs._id))throw new Error("For a new document use the method Set");return this.update.$addToSet||(this.update.$addToSet={}),this.update.$addToSet[e]=t,this},pop:function(e,t){if(!(this instanceof s)){if(!this.attrs._id)throw new Error("For a new document use the method Set");if(!i.Utils.isArray(this.attrs[e]))throw new Error("Field must by a type of array")}if(1!==t&&-1!==t)throw new Error("Position must be 1 or -1");return this.update.$pop||(this.update.$pop={}),this.update.$pop[e]=t,this},inc:function(e,t){if(!(this instanceof s||this.attrs._id))throw new Error("For a new document use the method Set");return this.update.$inc||(this.update.$inc={}),this.update.$inc[e]=t,this},currentDate:function(e,t){if(!(this instanceof s)){if(!this.attrs._id)throw new Error("For a new document use the method Set");if(!0!==t&&"timestamp"!==t&&"date"!==t)throw new Error("Invalid type")}return this.update.$currentDate||(this.update.$currentDate={}),this.update.$currentDate[e]="timestamp"===t||"date"===t?{$type:t}:t,this},mul:function(e,t){if(!(this instanceof s)){if(!this.attrs._id)throw new Error("For a new document use the method Set");if(!i.Utils.isNumber(this.attrs[e]))throw new Error("Field must by a type of number")}if(!i.Utils.isNumber(t))throw new Error("Value must by a type of number");return this.update.$mul||(this.update.$mul={}),this.update.$mul[e]=t,this},min:function(e,t){if(!(this instanceof s)){if(!this.attrs._id)throw new Error("For a new document use the method Set");if(!i.Utils.isNumber(this.attrs[e]))throw new Error("Field must by a type of number")}if(!i.Utils.isNumber(t))throw new Error("Value must by a type of number");return this.update.$min||(this.update.$min={}),this.update.$min[e]=t,this},max:function(e,t){if(!(this instanceof s)){if(!this.attrs._id)throw new Error("For a new document use the method Set");if(!i.Utils.isNumber(this.attrs[e]))throw new Error("Field must by a type of number")}if(!i.Utils.isNumber(t))throw new Error("Value must by a type of number");return this.update.$max||(this.update.$max={}),this.update.$max[e]=t,this}},s=function(){function e(){for(var t in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.update={},o)this[t]=o[t]}return r(e,[{key:"toJson",value:function(){return this.update}}]),e}();n.operators=o,n.SCUpdateOps=s},{"./utils":48}],47:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SCUser=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./protocol"),o=e("./httpRequest"),s=e("./utils"),a=e("./client"),u=e("./object");n.SCUser=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,Object.getPrototypeOf(t).call(this,"users",e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"signup",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n={url:a.SDKOptions.SIGN_UP_URL},r={username:this.attrs.username,email:this.attrs.email,password:this.attrs.password},u=i.UserProtocol.init(r,this.attrs,n),c=new o.HttpRequest(u),l=c.execute().then((function(e){return JSON.parse(e)})).then((function(t){return t.error?Promise.reject(t):(s.Utils.extend(e.attrs,t.result),t.result)}));return s.Utils.wrapCallbacks(l,t)}},{key:"logout",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t={url:a.SDKOptions.LOGOUT_URL},n=i.UserProtocol.init(null,null,t),r=new o.HttpRequest(n),u=r.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error||(a.Client.getInstance().sessionId=""),e}));return s.Utils.wrapCallbacks(u,e)}},{key:"authorize",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n={url:a.SDKOptions.GET_AUTH_URL},r=i.UserProtocol.init(null,null,n),u=new o.HttpRequest(r),c=u.execute().then((function(e){return JSON.parse(e)})).then((function(t){return t.error?Promise.reject(t):(a.Client.getInstance().sessionId=t.result.sessionId,s.Utils.extend(e.attrs,t.result.user),t.result.user)}));return s.Utils.wrapCallbacks(c,t)}},{key:"login",value:function(e,t){var n=this,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],u={url:a.SDKOptions.LOGIN_URL},c=i.UserProtocol.init({email:e,password:t},null,u),l=new o.HttpRequest(c),f=l.execute().then((function(e){return JSON.parse(e)})).then((function(e){return e.error?Promise.reject(e):(a.Client.getInstance().sessionId=e.result.sessionId,s.Utils.extend(n.attrs,e.result.user),e.result.user)}));return s.Utils.wrapCallbacks(f,r)}}]),t}(u.SCObject)},{"./client":30,"./httpRequest":32,"./object":37,"./protocol":40,"./utils":48}],48:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i={isNumber:function(e){return"[object Number]"===toString.call(e)},isObject:function(e){var t="undefined"==typeof e?"undefined":r(e);return"function"===t||"object"===t&&!!e}};i.isArray=Array.isArray||function(e){return"[object Array]"===toString.call(e)},i.wrapCallbacks=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return e.then((function(e){return t.success&&t.success(e),e})).catch((function(e){return t.error&&t.error(e),Promise.reject(e)}))},i.extend=function(e,t){for(var n in t)e[n]=t[n]},i.removeElement=function(e,t){return e.filter((function(e){return t!==e?t:void 0}))},i.promiseWhile=function(e,t){return new Promise((function(n,r){!function i(o){return e(o)?void t(o).then(i,r):n()}()}))},n.Utils=i},{}],49:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SCWebSocket=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./client");n.SCWebSocket=function(){function t(n){arguments.length<=1||void 0===arguments[1]||arguments[1],function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=this;if(!n)throw new Error("Channel name is empty");var o=i.Client.getInstance(),s=o.isNode?e("ws"):WebSocket,a=o.applicationID,u=o.websocketKey,c=o.get("WSHOST"),l=o.get("WS_PROTOCOL");this.wsInstanse=new s(l+"://"+c+"/"+a+"/"+u+"/"+n),this._handlers={},this.wsInstanse.onclose=function(e){r._emit("close",{wasClean:e.wasClean,code:e.code,reason:e.reason})},this.wsInstanse.onerror=function(e){r._emit("error",e)},this.wsInstanse.onmessage=function(e){r._emit("message",e.data)},this.wsInstanse.onopen=function(){r._emit("open")}}return r(t,[{key:"_emit",value:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.shift();this._handlers[n]||(this._handlers[n]=[]);for(var r=this._handlers[n].length,i=0;r>i;i++)this._handlers[n][i].apply(null,e)}},{key:"on",value:function(e,t){this._handlers[e]||(this._handlers[e]=[]),this._handlers[e].push(t)}},{key:"send",value:function(e){this.wsInstanse.send(e)}}]),t}()},{"./client":30,ws:13}]},{},[42])(42)}).call(this,n(22))},20:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAdVBMVEX///8AAACAgIDj4+NRUVGSkpL19fVgYGAEBAQkJCSzs7PHx8c5OTlYWFjr6+v7+/scHByrq6vAwMC5ublsbGzQ0NDv7+/c3NxGRkbW1tY9PT1xcXGJiYkpKSlLS0t2dnaenp4WFhY6OjoxMTGYmJihoaGGhoaw4sdwAAAEeElEQVR4nO3d6XaqMBQF4MQBRKwos0PV3mrf/xGvHe6tJSfIkJpD1t4/61nhfGUUaCMEgiAIgiAIgiAIgvyPN26VZWRkGLPJa3zLeDppFf8SksbQbzeO0YySJCzItqI4la0TvBXEUPNV+5FMJniaJlRbz51GK8fEUIHhltsn2M2rXSVdf+8HlchAeDX68c9ttPtQI57Ca463R50O++C/vKy5CuUi+27qtcc4e7ZCKb+31D6jKJspI+E3sc8grIX/iX3G4C0MEteFcpu5LpS73HWhXDsvfN24LpSXyHVhMDYttPztSU1iWJilvqWUmhaPkVlh5FlLHi7IHg0L7SamvkUkLgmFd1B7PDolFIV6Q8Z3Sxid1CbdEopQXYmOCaOR60IxhRBCCK0HQgghtB8IIYTQfiCEEEL7gRBCCO0HQgghtB8IIYTQfiCEEEL7gRBCCO0HQgghtB8IIYTQfiCEEEL7gRBCCO0HQgghtB8IIYTQfiCEEEL7gRBCCO0HQgghtB8IIYTQfiCEEEL7gRBCCO0HQgghtB8IIYTQfiCEEEL7cV+4d11YPLkujNV/7O+WMD+qTbolXBNNOiWcU026JKQnWDMrtDmH5V4zP4pZIbUf2I7j88xICO8EQhaBsDYQsgiEtYGQRSCsDYQccnBeaHjeNYbCeY1wcVq/56jveghC/fyH+2zz2XWeZRNNzQCEpU64XXo3jS9DumoAwlAzD6ky8f1mS5UNQKiZS3Ze7VwIT52UbgjCMz0fsLIGP3ZHXy1kLywLQQn9MSUUsdo9e+HH/PHKT8sNCRRip5RyF6ZLUjiNNMKxMgMmc2H5uTFWfxwQhxndSuQtnMWCFKZaoEiqtbyFX0BFuNcLlVrWwljT9Yo8VXylOis0Y+Eq0a2XWmH18RVf4ST+bqrykRPCYH97Sq986IIwDX+c8CqfrvQnCyH+VIpZCsts+bOpakHdk+u7tdaFz9Miv9f1hL4qfU9craWEs5/p0uasU+RidGq0XoKELHvP/Wua+8M3SE0HnaIsYKS7Ls3V0g7DNxDWHQo6RFnAKqYLvQbfLYYhlKmyr35k/uKMUKYeURcSd2oGK5QTtSyrXpMOWyi31aqN+lbjsIVShjdbqpdrbgkPWiif4mJ8PflH43Gxe9HUDFt4zeEQx6fJQl8weOHdNBCW7Ud9DQclVP864G4OuosqnsKi/ah1d4oYCiP1DyDuZGEY+OtvQUdtt1PTwN9/z9s71xyNq5n5xoGPeJM9my6apdxdqEti/sLrZXuzZL/ge5DQaiCEkH8ghJB/zAujbH2emsncxM1h48JwtyVv6nRJ8Jz2N5oWxi+GdF8JTsyEmnf8+qQvsc+yCaEp1m3qHto+XNj6+26TpEuib0vC6GBKdZvnjI8wpO7990+/m299lvyop9yXXnff+iz5UUKfft7nkPCp16Gm07sEX3kbhJB4ublpXpXn4SyFm+4Lnii7B0uhOHdesHqa4imkXsJvlJM6Fk+hyLutxYw4STEVXvdFv+0R9XAhF8pR+BfT0o7cu8tgzAAAAABJRU5ErkJggg=="},23:function(e,t,n){e.exports={page:"App_page__fsVfh"}},26:function(e,t,n){e.exports=n(37)},31:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(14),s=n.n(o),a=(n(31),n(4)),u=n(5),c=n(8),l=n(6),f=n(9),h=n(23),p=n.n(h),d=n(2),v=n.n(d),y=n(12),m=n(15),g="CHANGE_FORM_NAME",_="CHANGE_FORM_COUNT",w="INIT_APP",b="SELECT_EQUIPMENT",E="UPDATE_OUTPUT_BUILDING",S="UPDATE_OUTPUT_EQUIPMENT";function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=n(24),P={outputBuildings:{},outputEquipment:{},selectEquipment:{id:void 0,isRoom:!1,block:{}},formAddEquipment:{name:"",count:"",room:""}},C=Object(y.c)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return x({},e,{buildings:t.buildings,equipment:t.equipment});case E:return x({},e,{outputBuildings:t.outputBuildings});case S:return x({},e,{outputEquipment:t.outputEquipment});case b:return x({},e,{selectEquipment:{id:t.id,isRoom:t.isRoom,block:t.block},formAddEquipment:x({},e.formAddEquipment,{room:t.id})});case g:return x({},e,{formAddEquipment:x({},e.formAddEquipment,{name:t.name})});case _:return x({},e,{formAddEquipment:x({},e.formAddEquipment,{count:t.count})});default:return e}}),Object(y.a)(k.a)),R=n(13),T=n.n(R),N=n(18);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:b,id:e,isRoom:t,block:n}}var D=function(){var e=function(){var e=Object(N.a)(T.a.mark((function e(n,r){var i,o;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(e){return e.find().then((function(e){return e.result.map((function(e){var t=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.map((function(i){if("undefined"!==typeof i.children){var o=e(i.children,t),s=r(i,n);return{id:i.id,name:i.name,parent:s,children:o,isEmpty:!0}}var a=r(i,n);return{id:i.id,parent:a,name:i.name,isEmpty:!0}}));function r(e,t){return"undefined"!==typeof t.length?t.find((function(t){return t.children.find((function(t){if(e.id===t.id)return!0}))})):t}}(e.rooms,e);return{id:e._id,name:e.name,children:t,isEmpty:!0}}))}))},e.next=3,i(n);case 3:return o=e.sent,e.next=6,t(o,r);case 6:return o=e.sent,e.next=9,C.dispatch({type:E,outputBuildings:o});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t=function(e,t){return function(e,t){return function e(n){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n.map((function(n){if("undefined"===typeof n.children)return t.filter((function(e){return n.id===e.room&&e.count>0})).length>0&&(n.isEmpty=!1),{ch:n,emp:!1};var r=e(n.children),i=[],o=[];r.map((function(e){i.push(e.ch),o.push(e.emp)}));var s=o.some((function(e){return e}));return n.isEmpty="undefined"!==typeof s&&!!s,"undefined"===typeof i[0]?L({},n,{children:n.children}):L({},n,{children:i})}))}(e)}(e,t)},n=function(e){return e.find().then((function(e){return e.result.map((function(e){return{id:e._id,name:e.name,count:e.count,room:e.room}}))})).then((function(e){return C.dispatch({type:S,outputEquipment:e}),e}))};return Object(N.a)(T.a.mark((function t(){var r,i,o;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new v.a.Query("buildings"),i=new v.a.Query("equipment"),t.next=4,n(i);case 4:return o=t.sent,t.next=7,e(r,o);case 7:case"end":return t.stop()}}),t)})))},I=n(7),B=n(1),j=n.n(B),M=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).addEquipment=function(e,t,n,r){e.preventDefault();var i=new v.a.Object("equipment");i.set("name",t),i.set("room",r),i.set("count",n),i.save().then((function(){C.dispatch(D())}))},n.changeName=function(e){var t;C.dispatch((t=e.target.value,{type:g,name:t}))},n.changeCount=function(e){var t;isNaN(e.target.value)||C.dispatch((t=+e.target.value,{type:_,count:t}))},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.state.formAddEquipment,n=t.name,r=t.count,o=t.room;return i.a.createElement("form",{className:j.a.addForm,onSubmit:function(t){return e.addEquipment(t,n,r,o)}},i.a.createElement("div",{className:j.a.title},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435:"),i.a.createElement("label",null,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435:",i.a.createElement("input",{type:"text",value:n,onChange:this.changeName})),i.a.createElement("label",null,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e:",i.a.createElement("input",{type:"text",value:r,onChange:this.changeCount})),i.a.createElement("button",null,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"))}}]),t}(i.a.Component);var q=Object(I.b)((function(e){return{formAddEquipment:e.formAddEquipment}}))((function(e){return i.a.createElement(M,{state:e})})),H=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).createTitle=function(e){if("undefined"!==typeof e.id){var t=function e(t){return"undefined"===typeof t.parent?t.name:e(t.parent)+"/"+t.name}(e.block);return i.a.createElement("div",{className:j.a.equipmentTitle},t," ")}return i.a.createElement("div",{className:j.a.equipmentTitle},"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0437\u0435\u043b \u0437\u0434\u0430\u043d\u0438\u044f")},n.createEquipment=function(e,t){var r=t.isRoom,o=t.id,s=t.block;if(0===Object.keys(e).length||"undefined"===typeof o)return i.a.createElement("div",null);var a=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.map((function(e){return t.id===e.room&&e.count>0&&i.a.createElement("div",{key:e.id,className:j.a.item},i.a.createElement("div",{className:j.a.name},"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435: ",e.name),i.a.createElement("div",null,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e: ",e.count))}));return n?r:r.every((function(e){return!e}))?i.a.createElement("div",null,"\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442"):r};if(r){var u=e.map((function(e){return 0!==e.count&&""!==e.room&&"undefined"!==typeof e.room&&(e.room===o&&i.a.createElement("div",{key:e.id,className:j.a.item},i.a.createElement("div",{className:j.a.name},e.name,": ",i.a.createElement("strong",null,e.count)),i.a.createElement("div",{className:j.a.buttons},i.a.createElement("div",{className:j.a.btn,onClick:function(){return n.changeEquipment(e.id,e.name,e.count)}},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),i.a.createElement("div",{className:j.a.btn,onClick:function(){return n.removeEquipment(e.id)}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"))))}));return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:j.a.equipmentList},i.a.createElement("div",{className:j.a.wrapperForm},i.a.createElement(q,null)),u))}return function e(t){return t.map((function(t){if("undefined"!==typeof t.children){var n=e(t.children),r=a(t);return i.a.createElement("div",{key:t.id,className:j.a.buildBlock},i.a.createElement("div",{className:j.a.blockTitle},t.name),i.a.createElement("div",null,r),i.a.createElement("div",null,n))}var o=a(t,!1);return i.a.createElement("div",{key:t.id,className:j.a.buildBlock},i.a.createElement("div",{className:j.a.blockTitle},t.name),i.a.createElement("div",{className:j.a.blockEquipmentList},o))}))}([s])},n.removeEquipment=function(e){var t=new v.a.Object("equipment");t.getById(e).then((function(e){t.remove(e).then((function(){C.dispatch(D())}))}))},n.changeEquipment=function(e,t,n){var r=new v.a.Object("equipment");r.set("_id",e).set("name",t).set("count",++n),r.save().then((function(){C.dispatch(D())}))},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.state,t=e.outputEquipment,n=e.selectEquipment,r=this.createEquipment(t,n),o=this.createTitle(n);return i.a.createElement("div",{className:j.a.equipment},o,i.a.createElement("div",{className:j.a.equipmentList},r))}}]),t}(i.a.Component);var F=Object(I.b)((function(e){return{outputEquipment:e.outputEquipment,selectEquipment:e.selectEquipment}}))((function(e){return i.a.createElement(H,{state:e})})),W=n(10),K=n.n(W),J=n(20),V=n.n(J),Y=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).createHierarchy=function(e){return function e(t){return t.map((function(t){var r="";if("undefined"!==typeof t.children){var o=e(t.children);return t.isEmpty||(r=i.a.createElement("img",{src:V.a,className:K.a.equipmentIcon})),i.a.createElement("div",{key:t.id,className:K.a.roomBlock},i.a.createElement("div",{className:K.a.title,onClick:function(){return n.selectNode(t)}},r,t.name),i.a.createElement("div",null,o))}return t.isEmpty||(r=i.a.createElement("img",{src:V.a,className:K.a.equipmentIcon})),i.a.createElement("div",{key:t.id,className:K.a.roomBlock,onClick:function(){return n.selectRoom(t)}},r,t.name)}))}(e)},n.selectNode=function(e){C.dispatch(U(e.id,!1,e))},n.selectRoom=function(e){C.dispatch(U(e.id,!0,e))},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=i.a.createElement("div",null);return 0!==Object.keys(this.props.state.outputBuildings).length&&(e=this.createHierarchy(this.props.state.outputBuildings)),i.a.createElement("div",{className:K.a.nav},i.a.createElement("div",{className:K.a.buildings},e))}}]),t}(i.a.Component);var G=Object(I.b)((function(e){return{outputBuildings:e.outputBuildings}}))((function(e){return i.a.createElement(Y,{state:e})})),$=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).initApp=function(){v.a.Init({ApplicationID:"3196b2e873234547ad8b06ed636d3538",JavaScriptKey:"5e85f685a23e44e6abad95accc1dd2ea",MasterKey:"659d718ff9664f6fafbdb79efc93cb34"}),C.dispatch(D())},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.initApp()}},{key:"render",value:function(){return i.a.createElement("div",{className:p.a.page},i.a.createElement(G,null),i.a.createElement(F,null))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(I.a,{store:C},i.a.createElement($,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.529e2b80.chunk.js.map